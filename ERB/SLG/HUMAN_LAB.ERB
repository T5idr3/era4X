;--------------------------
; 人体研究所
;--------------------------
@HUMAN_LAB
#DIM UPDATE_TARGET
UPDATE_TARGET = 0
DRAWLINE
SELECTCASE QUEST_PROGRESS:0
	CASE 3
		PRINTFORML 宇宙港近くの古い高層ビルの一室、そこに博士の人体研究所がある
		PRINTFORML 医療器械とベッド、そして本に囲まれ狭苦しいその部屋で、博士が%CALLNAME:MASTER%を出迎えた。
		PRINTFORML 「やあ、今日はどんな用かな？」
ENDSELECT

PRINTL
$INPUT_LOOP
DRAWLINE
IF UPDATE_TARGET == 0
	PRINTFORML 改造対象: ---
ELSE
	PRINTFORML 改造対象: %CALLNAME:UPDATE_TARGET%
ENDIF
DRAWLINE
PRINTBUTTON "[0]肉体変化          ", 0
PRINTBUTTON "[1]特性変化          ", 1
PRINTBUTTON "[2]技能変化          ", 2
PRINTBUTTON "[3]追加の投資        ", 3
PRINTL 
PRINTBUTTON "[4]奴隷選択          ", 4
SIF UPDATE_TARGET != 0
	PRINTBUTTON "[5]奴隷情報          ", 5
PRINTBUTTON "[9]戻る              ", 9
INPUT
IF RESULT == 0
	CALL CHANGE_BODY(UPDATE_TARGET)
	GOTO INPUT_LOOP
ELSEIF RESULT == 1
	CALL CHANGE_TALENT
	GOTO INPUT_LOOP
ELSEIF RESULT == 2
	CALL CHANGE_ABL
	GOTO INPUT_LOOP
ELSEIF RESULT == 3
	CALL ADD_INVESTING_DOCTOR
	GOTO INPUT_LOOP
ELSEIF RESULT == 4
	CALL SELECT_SLAVE
	UPDATE_TARGET = RESULT
	GOTO INPUT_LOOP
ELSEIF RESULT == 5 && UPDATE_TARGET != 0
	CALL SHOW_INFO(UPDATE_TARGET)
ELSEIF RESULT == 9
	PRINTFORMW 「また来てくれたまえよ。ぜひ実験体と一緒にね」
ELSE
	GOTO INPUT_LOOP
ENDIF

;--------------------------
; 肉体変化
;--------------------------
@CHANGE_BODY(ID)
#DIM ID
$INPUT_LOOP
RESULTS = 並乳
SIF TALENT:ID:絶壁 == 1
	RESULTS = 絶壁
SIF TALENT:ID:貧乳 == 1
	RESULTS = 貧乳
SIF TALENT:ID:巨乳 == 1
	RESULTS = 巨乳
SIF TALENT:ID:爆乳 == 1
	RESULTS = 爆乳
PRINTFORML 現在の%CALLNAME:ID%のバストサイズ: %RESULTS%
IF TALENT:ID:絶壁 == 1
	PRINT  絶壁 
ELSE
	PRINTBUTTON "[絶壁]", 0
ENDIF
IF TALENT:ID:貧乳 == 1
	PRINT  貧乳 
ELSE
	PRINTBUTTON "[貧乳]", 1
ENDIF
IF TALENT:ID:絶壁 == 0 && TALENT:ID:貧乳 == 0 && TALENT:ID:巨乳 == 0 && TALENT:ID:爆乳 == 0
	PRINT  並乳 
ELSE
	PRINTBUTTON "[並乳]", 2
ENDIF
IF TALENT:ID:巨乳 == 1
	PRINT  巨乳 
ELSE
	PRINTBUTTON "[巨乳]", 3
ENDIF
IF TALENT:ID:爆乳 == 1
	PRINT  爆乳 
ELSE
	PRINTBUTTON "[爆乳]", 4
ENDIF
PRINTL
PRINTBUTTON "[戻る]", 9
PRINTL
PRINTL 改造費用: $50,000
IF MONEY < 50000
	PRINTW 改造費用が足りない
	RETURN
ENDIF
INPUT
IF RESULT == 0 && TALENT:ID:絶壁 == 0
	PRINTFORML %CALLNAME:ID%の胸を絶壁にしますか？
	$INPUT_LOOP2
	PRINTBUTTON "[0]決定", 0
	PRINTBUTTON "[1]キャンセル", 1
	INPUT
	IF RESULT == 0
		PRINTFORMW %CALLNAME:ID%の胸を絶壁にしました
		CALL SET_BREAST_SIZE(ID, -2)
		MONEY -= 50000
		RETURN
	ELSEIF RESULT == 1
		GOTO INPUT_LOOP
	ELSE
		GOTO INPUT_LOOP2
	ENDIF
ELSEIF RESULT == 1 && TALENT:ID:貧乳 == 0
	PRINTFORML %CALLNAME:ID%の胸を貧乳にしますか？
	$INPUT_LOOP3
	PRINTBUTTON "[0]決定", 0
	PRINTBUTTON "[1]キャンセル", 1
	INPUT
	IF RESULT == 0
		CALL SET_BREAST_SIZE(ID, -1)
		PRINTFORMW %CALLNAME:ID%の胸を貧乳にしました
		MONEY -= 50000
		RETURN
	ELSEIF RESULT == 1
		GOTO INPUT_LOOP
	ELSE
		GOTO INPUT_LOOP3
	ENDIF
ELSEIF RESULT == 2 && TALENT:ID:絶壁 == 0 && TALENT:ID:貧乳 == 0 && TALENT:ID:巨乳 == 0 && TALENT:ID:爆乳 == 0
	PRINTFORML %CALLNAME:ID%の胸を並乳にしますか？
	$INPUT_LOOP4
	PRINTBUTTON "[0]決定", 0
	PRINTBUTTON "[1]キャンセル", 1
	INPUT
	IF RESULT == 0
		CALL SET_BREAST_SIZE(ID, 0)
		PRINTFORMW %CALLNAME:ID%の胸を並乳にしました
		MONEY -= 50000
		RETURN
	ELSEIF RESULT == 1
		GOTO INPUT_LOOP
	ELSE
		GOTO INPUT_LOOP4
	ENDIF
ELSEIF RESULT == 3 && TALENT:ID:巨乳 == 0
	PRINTFORML %CALLNAME:ID%の胸を巨乳にしますか？
	$INPUT_LOOP5
	PRINTBUTTON "[0]決定", 0
	PRINTBUTTON "[1]キャンセル", 1
	INPUT
	IF RESULT == 0
		CALL SET_BREAST_SIZE(ID, 1)
		PRINTFORMW %CALLNAME:ID%の胸を巨乳にしました
		MONEY -= 50000
		RETURN
	ELSEIF RESULT == 1
		GOTO INPUT_LOOP
	ELSE
		GOTO INPUT_LOOP5
	ENDIF
ELSEIF RESULT == 4 && TALENT:ID:爆乳 == 0
	PRINTFORML %CALLNAME:ID%の胸を爆乳にしますか？
	$INPUT_LOOP6
	PRINTBUTTON "[0]決定", 0
	PRINTBUTTON "[1]キャンセル", 1
	INPUT
	IF RESULT == 0
		CALL SET_BREAST_SIZE(ID, 2)
		PRINTFORMW %CALLNAME:ID%の胸を爆乳にしました
		MONEY -= 50000
		RETURN
	ELSEIF RESULT == 1
		GOTO INPUT_LOOP
	ELSE
		GOTO INPUT_LOOP6
	ENDIF
ELSEIF RESULT == 9
	RETURN
ELSE
	GOTO INPUT_LOOP
ENDIF
;--------------------------
; 特性変化
;--------------------------
@CHANGE_TALENT(TARGET_ID)
#DIM TARGET_ID
PRINTW 「すまない、資金が足りなくて特性変化はできないんだ」
RETURN

;--------------------------
; 技能変化
;--------------------------
@CHANGE_ABL(TARGET_ID)
#DIM TARGET_ID
PRINTW 「すまない、資金が足りなくて技能変化はできないんだ」
RETURN

;--------------------------
; 奴隷選択
;--------------------------
@SELECT_SLAVE
#DIM ITER
#DIM SELECTED
$INPUT_LOOP
DRAWLINE
PRINTFORML 改造する奴隷を選択してください
DRAWLINE
FOR ITER, 1, CHARANUM
	PRINTBUTTON @"[{ITER}]%CALLNAME:ITER, 20, LEFT%", ITER
	SIF ITER % 4 == 4
		PRINTL
NEXT
PRINTL
PRINTBUTTON @"[999]", 999
PRINTL
INPUT
IF RESULT > 0 && RESULT < CHARANUM
	SELECTED = RESULT
	$INPUT_LOOP2
	CALL SHOW_INFO(RESULT)
	PRINTBUTTON "[0]決定", 0
	PRINTBUTTON "[1]キャンセル", 1
	INPUT
	IF RESULT == 0
		RETURN SELECTED
	ELSEIF RESULT == 1
		GOTO INPUT_LOOP
	ELSE
		GOTO INPUT_LOOP2
	ENDIF
ELSEIF RESULT == 999
	RETURN 0
ELSE
	GOTO INPUT_LOOP
ENDIF

;--------------------------
; 追加投資
;--------------------------
@ADD_INVESTING_DOCTOR
PRINTFORML 「ありがたい！資金はいくらあっても困らないからね
PRINTFORML それで、いくら投資してくれるんだい？」
$INPUT_LOOP
INPUT
IF RESULT > 0 && MONEY >= RESULT
	PRINTFORML 「ありがとう！これで研究が進むよ」
	PRINTFORMW 博士は満面の笑みを浮かべて%CALLNAME:MASTER%に感謝している
ELSEIF MONEY < RESULT
	PRINTFORML 「はは、無い袖は振れないよ」
	GOTO INPUT_LOOP
ELSEIF RESULT == 0
	PRINTFORML 「やっぱり止めるのかい？気が向いたら頼むよ」
	RETURN
ELSE
	GOTO INPUT_LOOP
ENDIF



