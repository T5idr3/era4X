;--------------------------
; AI COUNTRY 社会主義国家
;--------------------------
@SLG_AI_ACTION_2
#DIM CONST COUNTRY_ID = 2
#DIM SHIPS, SHIP_TYPE_COUNT
#DIM CURRENT_WAITING_SHIPS, SHIP_TYPE_COUNT
#DIM STAR_ID
#DIM SHIP_ID
#DIM NEW_SHIP_ID
#DIM ITER
#DIM IS_COMPLETE

VARSET SHIPS, 0
VARSET CURRENT_WAITING_SHIPS, 0
IS_COMPLETE = 0

CALL COMMON_AI_ACTION(COUNTRY_ID)
CALL GET_INVASION_ARMY(SHIPS)
; 戦争目標が定まっていない場合
IF WAR_PHASE:COUNTRY_ID == 準備 && WAR_TARGET_POS:COUNTRY_ID == 0
    WAR_TARGET_POS:COUNTRY_ID = 星系座標ID:7
    MEETING_POINT:COUNTRY_ID = 星系座標ID:0 - 100
ELSEIF WAR_PHASE:COUNTRY_ID  == 準備
    IF SHIPS:フリゲート != INVASION_ARMY:COUNTRY_ID:フリゲート
        FOR STAR_ID, 0, 3
            CALL BUILD_SHIP(STAR_ID, COUNTRY_ID, フリゲート, "侵攻用フリゲート", NEW_SHIP_ID)
            IF RESULT == 1
                SHIP_MISSION:NEW_SHIP_ID = 移動
                MOVING_POS:NEW_SHIP_ID = MEETING_POINT:COUNTRY_ID
                INVASION_ARMY:COUNTRY_ID:フリゲート ++
            ENDIF
        NEXT
    ELSEIF SHIPS:コルベット != INVASION_ARMY:COUNTRY_ID:コルベット
        FOR STAR_ID, 0, 3
            CALL BUILD_SHIP(STAR_ID, COUNTRY_ID, コルベット, "侵攻用コルベット", NEW_SHIP_ID)
            IF RESULT == 1
                SHIP_MISSION:NEW_SHIP_ID = 移動
                MOVING_POS:NEW_SHIP_ID = MEETING_POINT:COUNTRY_ID
                INVASION_ARMY:COUNTRY_ID:コルベット ++
            ENDIF
        NEXT
    ELSEIF SHIPS:駆逐艦 != INVASION_ARMY:COUNTRY_ID:駆逐艦
        FOR STAR_ID, 0, 3
            CALL BUILD_SHIP(STAR_ID, COUNTRY_ID, 駆逐艦, "侵攻用駆逐艦", NEW_SHIP_ID)
            IF RESULT == 1
                SHIP_MISSION:NEW_SHIP_ID = 移動
                MOVING_POS:NEW_SHIP_ID = MEETING_POINT:COUNTRY_ID
                INVASION_ARMY:COUNTRY_ID:駆逐艦 ++
            ENDIF
        NEXT
    ELSEIF SHIPS:巡洋艦 != INVASION_ARMY:COUNTRY_ID:巡洋艦
        FOR STAR_ID, 0, 3
            CALL BUILD_SHIP(STAR_ID, COUNTRY_ID, 巡洋艦, "侵攻用巡洋艦", NEW_SHIP_ID)
            IF RESULT == 1
                SHIP_MISSION:NEW_SHIP_ID = 移動
                MOVING_POS:NEW_SHIP_ID = MEETING_POINT:COUNTRY_ID
                INVASION_ARMY:COUNTRY_ID:巡洋艦 ++
            ENDIF
        NEXT
    ELSEIF SHIPS:戦艦 != INVASION_ARMY:COUNTRY_ID:戦艦
        FOR STAR_ID, 0, 3
            CALL BUILD_SHIP(STAR_ID, COUNTRY_ID, 戦艦, "侵攻用戦艦", NEW_SHIP_ID)
            IF RESULT == 1
                SHIP_MISSION:NEW_SHIP_ID = 移動
                MOVING_POS:NEW_SHIP_ID = MEETING_POINT:COUNTRY_ID
                INVASION_ARMY:COUNTRY_ID:戦艦 ++
            ENDIF
        NEXT
    ELSE
        WAR_PHASE:COUNTRY_ID = 集合
    ENDIF
ELSEIF WAR_PHASE:COUNTRY_ID == 集合
    FOR SHIP_ID, 0, MAX_SHIP
        SIF SHIP_POSITION:SHIP_ID != MEETING_POINT:COUNTRY_ID
            CONTINUE
        SIF SHIP_COUNTRY:SHIP_ID != COUNTRY_ID
            CONTINUE
        CURRENT_WAITING_SHIPS:(SHIP_TYPE:SHIP_ID) ++
    NEXT
    FOR ITER, 0, SHIP_TYPE_COUNT
        SIF SHIPS:ITER != CURRENT_WAITING_SHIPS:ITER
            IS_COMPLETE = 1
    NEXT
    IF IS_COMPLETE == 0
        WAR_PHASE:COUNTRY_ID = 進撃
        SETCOLOR 0XFF0000
        PRINTL [ニュース] 社会主義国が民主主義国に向けて進軍を開始しました
        RESETCOLOR
        WAIT
        WAIT
    ENDIF
ELSEIF WAR_PHASE:COUNTRY_ID == 進撃
    FOR SHIP_ID, 0, MAX_SHIP
        SIF SHIP_COUNTRY:SHIP_ID != COUNTRY_ID
            CONTINUE
        IF SHIP_POSITION:SHIP_ID == MEETING_POINT:COUNTRY_ID && SHIP_MISSION == 待機
            SHIP_MISSION:SHIP_ID = 移動
            MOVING_POS:SHIP_ID = WAR_TARGET_POS:COUNTRY_ID
        ELSEIF SHIP_POSITION:SHIP_ID == WAR_TARGET_POS:COUNTRY_ID
            SHIP_MISSION:SHIP_ID = 移動
            MOVING_POS:SHIP_ID = 星系座標ID:0
            WAR_PHASE:COUNTRY_ID = 退却
        ENDIF
    NEXT
ELSEIF WAR_PHASE:COUNTRY_ID == 退却
    SETCOLOR 0XFF0000
    PRINTL [ニュース] 社会主義国の侵攻により民主主義国家の防衛部隊が壊滅しました
    RESETCOLOR
    WAIT
    WAIT
    WAR_PHASE:COUNTRY_ID = 準備
    FOR SHIP_ID, 0, MAX_SHIP
        SIF SHIP_COUNTRY:SHIP_ID != COUNTRY_ID
            CONTINUE
        SIF SHIP_MISSION:SHIP_ID == パトロール
            CONTINUE
        SHIP_MISSION:SHIP_ID = 移動
        MOVING_POS:SHIP_ID = 星系座標ID:0
    NEXT
ENDIF

@GET_STANDING_ARMY(UNIT)
#DIM REF UNIT

UNIT:フリゲート = 30
UNIT:コルベット = 20
UNIT:駆逐艦 = 10

@GET_INVASION_ARMY(UNIT)
#DIM REF UNIT
UNIT:フリゲート = 33
UNIT:コルベット = 21
UNIT:駆逐艦 = 12
UNIT:巡洋艦 = 6
UNIT:戦艦 = 3
