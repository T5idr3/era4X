; ランダムキャラ作成
@RANDOM_CHARA(TYPE, CHARA_PRICE)
#DIM TYPE
#DIM CHARA_PRICE
#DIM NEW_CHARA_ID
#DIM CURRENT_FILTER
#DIM FILTER, 3
#DIM DFILTER, 150

RESULT = 0
CURRENT_FILTER = 0
ADDVOIDCHARA
NEW_CHARA_ID = CHARANUM - 1
WHILE RESULT != 1
	DRAWLINE
	T = NEW_CHARA_ID
	CALL RANDMIZE_STATUS(NEW_CHARA_ID, TYPE)
	CALL GET_RANDOM_BODY(NEW_CHARA_ID)
	SIF CURRENT_FILTER == 1
		CALL UPDATE_BY_SOFT_FILTER(NEW_CHARA_ID, FILTER)
	SIF CURRENT_FILTER == 2
		CALL UPDATE_BY_DETAIL_FILTER(NEW_CHARA_ID, DFILTER)
	CALL SHOW_INFO(NEW_CHARA_ID)
	DRAWLINE
	PRINTBUTTON "[1]決定", 1
	PRINTBUTTON "[2]次へ", 2
	PRINTBUTTON "[3]無料フィルタ", 3
	PRINTBUTTON "[4]詳細フィルタ", 4
	PRINTBUTTON "[5]戻る", 5

	INPUT
	IF RESULT == 1
		IF MONEY < CHARA_PRICE
			PRINTFORMW 所持金が足りません
			RETURN
		ENDIF
		MONEY -= CHARA_PRICE
		CALL CHECK_CHANGE_NAME(NEW_CHARA_ID)
		SIF RESULT == 1
			CALL INPUT_NAME(NEW_CHARA_ID)
		CALL SELECT_EMPLOY_TYPE(NEW_CHARA_ID)
		CALL INIT_ROUTE(NEW_CHARA_ID)
		CALL KOJO_SELECT(NEW_CHARA_ID)
		CHARACTER_POSITION:NEW_CHARA_ID = CHARACTER_POSITION:0
		RESULT = 1
	ELSEIF RESULT == 3
		CALL SOFT_FILTER(FILTER)
		CHARA_PRICE = 1000
		CURRENT_FILTER = 1
	ELSEIF RESULT == 4
		CALL DETAIL_FILTER(DFILTER)
		CHARA_PRICE = RESULT
		CURRENT_FILTER = 2
	ELSEIF RESULT == 5
		DELCHARA (NEW_CHARA_ID)
		RETURN
	ENDIF
WEND

; ランダムステータス
@RANDMIZE_STATUS(ID, TYPE)
#DIM ID
#DIM TYPE

SIF TYPE == 0
	TYPE = RAND:4 + 1
NAME:ID = %GET_RANDOM_NAME()%
CALLNAME:ID = %NAME:ID%
SELECTCASE TYPE
	CASE 1
		CALL RANDMIZE_STATUS_TYPE_1(ID)
	CASE 2
		CALL RANDMIZE_STATUS_TYPE_2(ID)
	CASE 3
		CALL RANDMIZE_STATUS_TYPE_3(ID)
	CASE 4
		CALL RANDMIZE_STATUS_TYPE_4(ID)
ENDSELECT
CALL INIT_CHARA_FROM_RANDOM_HISTORY(ID, TYPE)

; ランダムJK作成
; 体力↑気力↓
@RANDMIZE_STATUS_TYPE_1(ID)
#DIM ID

BASE:ID:0 = RAND(10) * 60 + 1500
BASE:ID:1 = RAND(10) * 100 + 1000
MAXBASE:ID:0 = BASE:ID:0
MAXBASE:ID:1 = BASE:ID:1

CALL SET_RANDOM_PERSONALITY(ID)

; ランダムJD作成
@RANDMIZE_STATUS_TYPE_2(ID)
#DIM ID

BASE:ID:0 = RAND(7) * 100 + 1300
BASE:ID:1 = RAND(7) * 100 + 1300
MAXBASE:ID:0 = BASE:ID:0
MAXBASE:ID:1 = BASE:ID:1

CALL SET_RANDOM_PERSONALITY(ID)


; ランダムOL作成
; 体力↓気力↑
@RANDMIZE_STATUS_TYPE_3(ID)
#DIM ID

BASE:ID:0 = RAND(10) * 100 + 1000
BASE:ID:1 = RAND(10) * 60 + 1500
MAXBASE:ID:0 = BASE:ID:0
MAXBASE:ID:1 = BASE:ID:1

CALL SET_RANDOM_PERSONALITY(ID)


; ランダム未亡人作成
; 体力↓気力↓ 経験豊富
@RANDMIZE_STATUS_TYPE_4(ID)
#DIM ID

BASE:ID:0 = RAND(10) * 100 + 1000
BASE:ID:1 = RAND(10) * 100 + 1000
MAXBASE:ID:0 = BASE:ID:0
MAXBASE:ID:1 = BASE:ID:1

CALL SET_RANDOM_PERSONALITY(ID)

@CHECK_CHANGE_NAME(ID)
#DIM ID
$INPUT_LOOP
PRINTFORML %CALLNAME:ID%に新しい名前を付けますか?
PRINTBUTTON "[0] はい", 0
PRINTL
PRINTBUTTON "[1] いいえ", 1
INPUT
IF RESULT == 0
	RETURN 1
ELSEIF RESULT == 1
	RETURN 0
ELSE
	GOTO INPUT_LOOP
ENDIF


@INPUT_NAME(ID)
#DIM ID
#DIMS NEW_NAME
#DIMS NEW_CALLNAME
$INPUT_LOOP
PRINTFORML %CALLNAME:ID%の新しい名前を入力してください
INPUTS
NEW_NAME = %RESULTS%
SIF STRLENS(RESULTS) == 0
	GOTO INPUT_LOOP
$INPUT_CALLNAME
PRINTFORML %CALLNAME:ID%の新しい呼び名を入力してください
INPUTS
SIF STRLENS(RESULTS) == 0
	GOTO INPUT_CALLNAME
NEW_CALLNAME = %RESULTS%

$INPUT_LOOP2
PRINTFORML 以下でよろしいでしょうか
PRINTFORML 名前  : %NEW_NAME%
PRINTFORML 呼び名: %NEW_CALLNAME%

PRINTBUTTON "[1]決定", 1
PRINTBUTTON "[2]やり直す", 2
INPUT
IF RESULT == 1
	NAME:ID = %NEW_NAME%
	CALLNAME:ID = %NEW_CALLNAME%
ELSEIF RESULT == 2
	GOTO INPUT_LOOP
ELSE
	GOTO INPUT_LOOP2
ENDIF
RETURN 1

@SET_RANDOM_PERSONALITY(ID, 色物度合い)
#DIM ID
#DIM ITER
#DIM 色物度合い
SIF 色物度合い == 0
	色物度合い = 30

TALENT:ID:処女 = 1
CALL GET_RANDOM_SENSITIVITY
FOR ITER, 1, 5
	CALL SET_SENSITIVITY(ID, ITER, RESULT:ITER)
NEXT
IF RAND:100 < 色物度合い
	CALL GET_RANDOM_BREAST_SIZE
	CALL SET_BREAST_SIZE(ID, RESULT)
ENDIF
CALL RESET_TALENT(ID, 10, 9)
SIF RAND:100 < 色物度合い
	CALL SET_PERSONALITY(ID, GET_RANDOM_TALENT(10, 9))
	
CALL RESET_TALENT(ID, 20, 9)
SIF RAND:100 < 色物度合い
	CALL SET_INTEREST_SEX(ID, GET_RANDOM_TALENT(20, 9))

CALL RESET_TALENT(ID, 30, 7)
SIF RAND:100 < 色物度合い
	CALL SET_MIND(ID, GET_RANDOM_TALENT(30, 7))

; 癖が強いものは確率低め
CALL RESET_TALENT(ID, 40, 4)
SIF RAND: 125 < 色物度合い
	CALL SET_MAKEUP(ID, GET_RANDOM_TALENT(40, 4))

CALL RESET_TALENT(ID, 50, 7)
SIF RAND:125 < 色物度合い
	CALL SET_TECHNIQUE(ID, GET_RANDOM_TALENT(50, 7))

CALL RESET_TALENT(ID, 60, 4)
SIF RAND:100 < 色物度合い
	CALL SET_INNOCENT(ID, GET_RANDOM_TALENT(60, 4))

CALL RESET_TALENT(ID, 70, 3)
SIF RAND: 125 < 色物度合い
	CALL SET_HONESTLY(ID, GET_RANDOM_TALENT(70, 3))

;ここだけ嫉妬と妄信をはじくための処理を入れてるので数値がおかしい
CALL RESET_TALENT(ID, 80, 9)
SIF RAND: 125 < 色物度合い
	CALL SET_FEATURE(ID, GET_RANDOM_TALENT(80, 7))

CALL RESET_TALENT(ID, 92, 2)
SIF RAND: 200 < 色物度合い
	CALL SET_CHARM(ID, GET_RANDOM_TALENT(92, 2))

CALL RESET_TALENT(ID, 130, 2)
SIF RAND: 200 < 色物度合い
	CALL SET_SPECIAL(ID, GET_RANDOM_TALENT(130, 2))


; 敏感鈍感決定
; RESULT:1 Ｃ, RESULT:2 Ｖ, RESULT:3 Ａ, RESULT:4 Ｂ
@GET_RANDOM_SENSITIVITY
#DIM ITER

FOR ITER, 1, 5
	SELECTCASE RAND:4
		CASE 0, 1
			RESULT:ITER = 0
		CASE 2
			RESULT:ITER = -1
		CASE 3
			RESULT:ITER = 1
	ENDSELECT
NEXT
@SET_SENSITIVITY(ID, POS, SENSITIVITY)
#DIM ID
#DIM POS
#DIM SENSITIVITY

SELECTCASE POS
	CASE 1
		IF SENSITIVITY == -1
			TALENT:ID:Ｃ鈍感 = 1
			TALENT:ID:Ｃ敏感 = 0
		ELSEIF SENSITIVITY == 0
			TALENT:ID:Ｃ鈍感 = 0
			TALENT:ID:Ｃ敏感 = 0
		ELSE
			TALENT:ID:Ｃ鈍感 = 0
			TALENT:ID:Ｃ敏感 = 1
		ENDIF
	CASE 2
		IF SENSITIVITY == -1
			TALENT:ID:Ｖ鈍感 = 1
			TALENT:ID:Ｖ敏感 = 0
		ELSEIF SENSITIVITY == 0
			TALENT:ID:Ｖ鈍感 = 0
			TALENT:ID:Ｖ敏感 = 0
		ELSE
			TALENT:ID:Ｖ鈍感 = 0
			TALENT:ID:Ｖ敏感 = 1
		ENDIF
	CASE 3
		IF SENSITIVITY == -1
			TALENT:ID:Ａ鈍感 = 1
			TALENT:ID:Ａ敏感 = 0
		ELSEIF SENSITIVITY == 0
			TALENT:ID:Ａ鈍感 = 0
			TALENT:ID:Ａ敏感 = 0
		ELSE
			TALENT:ID:Ａ鈍感 = 0
			TALENT:ID:Ａ敏感 = 1
		ENDIF
	CASE 4
		IF SENSITIVITY == -1
			TALENT:ID:Ｂ鈍感 = 1
			TALENT:ID:Ｂ敏感 = 0
		ELSEIF SENSITIVITY == 0
			TALENT:ID:Ｂ鈍感 = 0
			TALENT:ID:Ｂ敏感 = 0
		ELSE
			TALENT:ID:Ｂ鈍感 = 0
			TALENT:ID:Ｂ敏感 = 1
		ENDIF
ENDSELECT

;ランダムでバストサイズ算出
@GET_RANDOM_BREAST_SIZE
RETURN RAND:5 - 2

; バストサイズ設定
@SET_BREAST_SIZE(ID, BREAST_SIZE)
#DIM ID
#DIM BREAST_SIZE
SELECTCASE BREAST_SIZE
	CASE -2
		TALENT:ID:絶壁 = 1
		TALENT:ID:貧乳 = 0
		TALENT:ID:巨乳 = 0
		TALENT:ID:爆乳 = 0
	CASE -1
		TALENT:ID:絶壁 = 0
		TALENT:ID:貧乳 = 1
		TALENT:ID:巨乳 = 0
		TALENT:ID:爆乳 = 0
	CASE 0
		TALENT:ID:絶壁 = 0
		TALENT:ID:貧乳 = 0
		TALENT:ID:巨乳 = 0
		TALENT:ID:爆乳 = 0
	CASE 1
		TALENT:ID:絶壁 = 0
		TALENT:ID:貧乳 = 0
		TALENT:ID:巨乳 = 1
		TALENT:ID:爆乳 = 0
	CASE 2
		TALENT:ID:絶壁 = 0
		TALENT:ID:貧乳 = 0
		TALENT:ID:巨乳 = 0
		TALENT:ID:爆乳 = 1
ENDSELECT

@RESET_TALENT(ID, START, LENGTH)
#DIM ID
#DIM START
#DIM LENGTH
#DIM ITER
FOR ITER, START, START + LENGTH
	TALENT:ID:ITER = 0
NEXT

@GET_RANDOM_TALENT(START, LENGTH)
#FUNCTION
#DIM START
#DIM LENGTH
RETURNF RAND:LENGTH + START

;性格を設定する
@SET_PERSONALITY(ID, PERSONALITY)
#DIM ID
#DIM PERSONALITY
SELECTCASE PERSONALITY
	CASE 10
		TALENT:ID:PERSONALITY = 1
		TALENT:ID:11 = 0
	CASE 11
		TALENT:ID:10 = 0
		TALENT:ID:PERSONALITY = 1
	CASE 12
		TALENT:ID:PERSONALITY = 1
		TALENT:ID:13 = 0
	CASE 13
		TALENT:ID:12 = 0
		TALENT:ID:PERSONALITY = 1
	CASE 14
		TALENT:ID:PERSONALITY = 1
		TALENT:ID:15 = 0
	CASE 15
		TALENT:ID:PERSONALITY = 1
		TALENT:ID:17 = 0
	CASE 16
		TALENT:ID:PERSONALITY = 1
	CASE 17
		TALENT:ID:15 = 0
		TALENT:ID:PERSONALITY = 1
	CASE 18
		TALENT:ID:PERSONALITY = 1
ENDSELECT

@SET_INTEREST_SEX(ID, INTEREST_SEX)
#DIM ID
#DIM INTEREST_SEX

SELECTCASE INTEREST_SEX
	CASE 20
		TALENT:ID:INTEREST_SEX = 1
	CASE 21
		TALENT:ID:INTEREST_SEX = 1
		TALENT:ID:23 = 0
	CASE 22
		TALENT:ID:INTEREST_SEX = 1
	CASE 23
		TALENT:ID:21 = 0
		TALENT:ID:INTEREST_SEX = 1
		TALENT:ID:24 = 0
	CASE 24
		TALENT:ID:23 = 0
		TALENT:ID:INTEREST_SEX = 1
	CASE 25
		TALENT:ID:INTEREST_SEX = 1
		TALENT:ID:26 = 0
	CASE 26
		TALENT:ID:25 = 0
		TALENT:ID:INTEREST_SEX = 1
	CASE 27
		TALENT:ID:INTEREST_SEX = 1
		TALENT:ID:28 = 0
	CASE 28
		TALENT:ID:27 = 0
		TALENT:ID:INTEREST_SEX = 1
ENDSELECT

;乙女心
@SET_MIND(ID, MIND)
#DIM ID
#DIM MIND

SELECTCASE MIND
	CASE 30
		TALENT:ID:MIND = 1
		TALENT:ID:31 = 0
	CASE 31
		TALENT:ID:30 = 0
		TALENT:ID:MIND = 1
	CASE 32
		TALENT:ID:MIND = 1
		TALENT:ID:33 = 0
	CASE 33
		TALENT:ID:32 = 0
		TALENT:ID:MIND = 1
		TALENT:ID:34 = 0
	CASE 34
		TALENT:ID:33 = 0
		TALENT:ID:MIND = 1
	CASE 35
		TALENT:ID:MIND = 1
		TALENT:ID:36 = 0
	CASE 36
		TALENT:ID:35 = 0		
		TALENT:ID:MIND = 1
ENDSELECT

; 体質
@SET_MAKEUP(ID, MAKEUP)
#DIM ID
#DIM MAKEUP

SELECTCASE MAKEUP
	CASE 40
		TALENT:ID:MAKEUP = 1
		TALENT:ID:41 = 0
	CASE 41
		TALENT:ID:40 = 0
		TALENT:ID:MAKEUP = 1
	CASE 42
		TALENT:ID:MAKEUP = 1
		TALENT:ID:43 = 0
	CASE 43
		TALENT:ID:42 = 0
		TALENT:ID:MAKEUP = 1
ENDSELECT

; 技術
@SET_TECHNIQUE(ID, TECHNIQUE)
#DIM ID
#DIM TECHNIQUE

SELECTCASE TECHNIQUE
	CASE 50
		TALENT:ID:TECHNIQUE = 1
		TALENT:ID:51 = 0
	CASE 51
		TALENT:ID:50 = 0
		TALENT:ID:TECHNIQUE = 1
	CASE 52
		TALENT:ID:TECHNIQUE = 1
	CASE 53
		TALENT:ID:TECHNIQUE = 1
	CASE 54
		TALENT:ID:TECHNIQUE = 1
	CASE 55
		TALENT:ID:TECHNIQUE = 1
	CASE 56
		TALENT:ID:TECHNIQUE = 1
ENDSELECT

;潔癖度
@SET_INNOCENT(ID, INNOCENT)
#DIM ID
#DIM INNOCENT
SELECTCASE INNOCENT
	CASE 60
		TALENT:ID:INNOCENT = 1
	CASE 61
		TALENT:ID:INNOCENT = 1
		TALENT:ID:62 = 0
	CASE 62
		TALENT:ID:61 = 0
		TALENT:ID:INNOCENT = 1
	CASE 63
		TALENT:ID:INNOCENT = 1
ENDSELECT

;正直度
@SET_HONESTLY(ID, HONESTLY)
#DIM ID
#DIM HONESTLY
SELECTCASE HONESTLY
	CASE 70
		TALENT:ID:HONESTLY = 1
		TALENT:ID:71 = 0
	CASE 71
		TALENT:ID:70 = 0
		TALENT:ID:HONESTLY = 1
	CASE 72
		TALENT:ID:HONESTLY = 1
ENDSELECT

;性愛性
@SET_FEATURE(ID, FEATURE)
#DIM ID
#DIM FEATURE
SELECTCASE FEATURE
	CASE 80
		TALENT:ID:FEATURE = 1
	CASE 81
		TALENT:ID:FEATURE = 1
	CASE 82
		TALENT:ID:FEATURE = 1
	CASE 83
		TALENT:ID:FEATURE = 1
	CASE 84
		TALENT:ID:FEATURE = 1
	CASE 85
		TALENT:ID:87 = 1
	CASE 86
		TALENT:ID:88 = 1
ENDSELECT

;魅了
@SET_CHARM(ID, CHARM)
#DIM ID
#DIM CHARM
SELECTCASE CHARM
	CASE 92
		TALENT:ID:CHARM = 1
	CASE 93
		TALENT:ID:CHARM = 1
ENDSELECT

;特殊
@SET_SPECIAL(ID, SPECIAL)
#DIM ID
#DIM SPECIAL
SELECTCASE SPECIAL
	CASE 130
		TALENT:ID:SPECIAL = 1
		TALENT:ID:131 = 0
	CASE 131
		TALENT:ID:130 = 0
		TALENT:ID:SPECIAL = 1
ENDSELECT

;------------------------
; キャラの経歴を算出し、経験を加算する
;------------------------
@INIT_CHARA_FROM_RANDOM_HISTORY(ID, TYPE)
#DIM ID
#DIM TYPE
#DIM CONST JK = 1
#DIM CONST JD = 2
#DIM CONST OL = 3
#DIM CONST 未亡人 = 4
#DIM ITER
FOR ITER, 0, 71
	EXP:ID:ITER = 0
	ABL:ID:ITER = 0
NEXT


; TODO 分岐を増やす
SELECTCASE RAND:10
	; うぶ
	CASE 0
		RETURN
	; オナニーだけ
	CASE 1
		EXP:ID:絶頂経験 = RAND:60 + 1
		EXP:ID:自慰経験 = EXP:ID:絶頂経験 + RAND:5
		ABL:ID:Ｃ感覚 = 1
	; 彼氏とキスまで
	CASE 2
		EXP:ID:絶頂経験 = RAND:60 + 1
		EXP:ID:自慰経験 = EXP:ID:絶頂経験 + RAND:5
		ABL:ID:Ｃ感覚 = 1
	; 彼氏と何度かセックス
	CASE 3
		EXP:ID:絶頂経験 = RAND:35 + 10
		EXP:ID:自慰経験 = EXP:ID:絶頂経験 - RAND:10
		EXP:ID:Ｖ経験 = RAND:30 + 1
		EXP:ID:性交経験 = EXP:ID:Ｖ経験
		EXP:ID:膣射経験 = RAND:(EXP:ID:Ｖ経験)
		ABL:ID:欲望 = 1
		ABL:ID:技巧 = 1
		ABL:ID:Ｃ感覚 = 2
		ABL:ID:Ｂ感覚 = 1
		ABL:ID:Ｖ感覚 = 1
		TALENT:ID:処女 = 0
	; 彼氏に開発された
	CASE 4
		EXP:ID:絶頂経験 = RAND:70 + 30
		EXP:ID:自慰経験 = EXP:ID:絶頂経験 - RAND:30
		EXP:ID:Ｖ経験 = RAND:60 + 1
		EXP:ID:Ａ経験 = RAND: 20 + 1
		EXP:ID:性交経験 = EXP:ID:Ｖ経験
		EXP:ID:膣射経験 = RAND:(EXP:ID:Ｖ経験)
		EXP:ID:精液経験 = RAND:20 + 1
		EXP:ID:フェラ経験 = RAND: 20 + 1
		ABL:ID:欲望 = 2
		ABL:ID:技巧 = 2
		ABL:ID:Ｃ感覚 = RAND:3 + 1
		ABL:ID:Ｂ感覚 = RAND:2 + 1
		ABL:ID:Ｖ感覚 = RAND:2 + 1
		ABL:ID:Ａ感覚 = 1
		TALENT:ID:処女 = 0
	; レズ
	CASE 5
		EXP:ID:Ｖ経験 = RAND:20 + 1
		EXP:ID:絶頂経験 = RAND:20 + 10
		EXP:ID:奉仕快楽経験 = 20
		EXP:ID:レズ経験 = RAND:100 + 100
		TALENT:ID:処女 = 0
	; 親族に犯された
	CASE 6
		EXP:ID:絶頂経験 = 1
		EXP:ID:Ｖ経験 = RAND:30 + 1
		EXP:ID:Ａ経験 = RAND:10 + 1
		EXP:ID:性交経験 = EXP:ID:Ｖ経験
		EXP:ID:膣射経験 = EXP:ID:Ｖ経験
		EXP:ID:精液経験 = RAND:20 + 1
		EXP:ID:フェラ経験 = RAND: 30 + 1
		ABL:ID:欲望 = 1
		ABL:ID:技巧 = 1
		ABL:ID:Ｃ感覚 = RAND:2 + 1
		ABL:ID:Ｂ感覚 = RAND:2 + 1
		ABL:ID:Ｖ感覚 = RAND:2 + 1
		ABL:ID:Ａ感覚 = RAND:2 + 1
		TALENT:ID:処女 = 0
	; レイプされた
		EXP:ID:絶頂経験 = 2
		EXP:ID:Ｖ経験 = RAND:60 + 1
		EXP:ID:Ａ経験 = RAND: 20 + 1
		EXP:ID:性交経験 = EXP:ID:Ｖ経験
		EXP:ID:膣射経験 = RAND:(EXP:ID:Ｖ経験)
		EXP:ID:精液経験 = RAND:20 + 1
		EXP:ID:フェラ経験 = RAND: 20 + 1
		EXP:ID:苦痛快楽経験 = RAND:20 + 1
		EXP:ID:異常経験 = 1
		ABL:ID:技巧 = 1
		ABL:ID:Ｃ感覚 = 1
		ABL:ID:Ｂ感覚 = 1
		ABL:ID:Ｖ感覚 = 1
		ABL:ID:Ａ感覚 = 1
		TALENT:ID:処女 = 0
	; 軽度の調教を受けた奴隷
	CASE 7
		EXP:ID:絶頂経験 = RAND:40 + 1
		EXP:ID:精液経験 = RAND:20 + 1
		EXP:ID:フェラ経験 = RAND: 30 + 1
		ABL:ID:欲望 = 2
		ABL:ID:技巧 = 3
		ABL:ID:Ｃ感覚 = RAND:3 + 1
		ABL:ID:Ｂ感覚 = RAND:3 + 1
	CASE 8
	; 中度の調教を受けた奴隷
		EXP:ID:絶頂経験 = RAND:80 + 1
		EXP:ID:精液経験 = RAND:40 + 1
		EXP:ID:フェラ経験 = RAND: 60 + 1
		ABL:ID:従順 = 2
		ABL:ID:欲望 = 3
		ABL:ID:技巧 = 4
		ABL:ID:Ｃ感覚 = RAND:3 + 2
		ABL:ID:Ｂ感覚 = RAND:3 + 2
	; 穴も調教済みの奴隷
	CASE 9
		EXP:ID:絶頂経験 = RAND:100 + 100
		EXP:ID:自慰経験 = EXP:ID:絶頂経験 - RAND:30
		EXP:ID:調教自慰経験 = RAND:50 + 1
		EXP:ID:Ｖ経験 = RAND:100 + 100
		EXP:ID:Ａ経験 = RAND:100 + 100
		EXP:ID:性交経験 = EXP:ID:Ｖ経験
		EXP:ID:膣射経験 = RAND:(EXP:ID:Ｖ経験)
		EXP:ID:精液経験 = RAND:100 + 1
		EXP:ID:フェラ経験 = RAND:100 + 1
		ABL:ID:従順 = 3
		ABL:ID:欲望 = 4
		ABL:ID:技巧 = 5
		ABL:ID:Ｃ感覚 = RAND:3 + 3
		ABL:ID:Ｂ感覚 = RAND:3 + 3
		ABL:ID:Ｖ感覚 = RAND:3 + 3
		ABL:ID:Ａ感覚 = RAND:3 + 3
		TALENT:ID:処女 = 0
ENDSELECT
IF TYPE == 未亡人
	EXP:ID:家事経験 = RAND:1000
	IF TALENT:ID:処女 == 0 && RAND:100 < 20
		EXP:ID:出産経験 = RAND:3
		EXP:ID:Ｖ拡張経験 = EXP:ID:出産経験
	ENDIF
ENDIF
; 歌唱経験
SIF RAND:100 < 30
	EXP:ID:歌唱経験 = RAND:100

@GET_RANDOM_BODY(ID, TALL)
#DIM ID
#DIM TALL
#DIM BODY_BASE

; 身長
IF TALL == 0
	CFLAG:ID:1010 = RAND:35 + 135
ELSE
	CFLAG:ID:1010 = TALL
ENDIF

; 3サイズ
; 基本サイズを身長から算出
BODY_BASE = 55 + (CFLAG:ID:1010 - 135) / 2
IF TALENT:ID:絶壁 == 1
	CFLAG:ID:1011 = 5 + RAND:6 + BODY_BASE
ELSEIF TALENT:ID:貧乳 == 1
	CFLAG:ID:1011 = 12 + RAND:6 + BODY_BASE
ELSEIF TALENT:ID:巨乳 == 1
	CFLAG:ID:1011 = 24 + RAND:6 + BODY_BASE
ELSEIF TALENT:ID:爆乳 == 1
	CFLAG:ID:1011 = 30 + RAND:6 + BODY_BASE
ELSE
	CFLAG:ID:1011 = 18 + RAND:6 + BODY_BASE
ENDIF

CFLAG:ID:1012 = BODY_BASE

IF TALENT:ID:絶壁 == 1
	CFLAG:ID:1013 = 5 + RAND:6 + BODY_BASE
ELSEIF TALENT:ID:貧乳 == 1
	CFLAG:ID:1013 = 12 + RAND:6 + BODY_BASE
ELSEIF TALENT:ID:巨乳 == 1
	CFLAG:ID:1013 = 24 + RAND:6 + BODY_BASE
ELSEIF TALENT:ID:爆乳 == 1
	CFLAG:ID:1013 = 30 + RAND:6 + BODY_BASE
ELSE
	CFLAG:ID:1013 = 18 + RAND:6 + BODY_BASE
ENDIF

; 髪色
CFLAG:ID:1009 = RAND:0XFFFFFF

; 陰毛
CFLAG:ID:1014 = RAND:6

; 簡易フィルター
@SOFT_FILTER(FILTER)
#DIM REF FILTER
#DIM CONST VERGIN = 0
#DIM CONST BREAST = 1

FILTER:VERGIN = 0
FILTER:BREAST = 0

$INPUT_LOOP
PRINT 現在の設定: 
IF FILTER:VERGIN == 0
	PRINT [指定なし]
ELSEIF FILTER:VERGIN == 1
	PRINT [処女]
ELSE
	PRINT [非処女]
ENDIF
IF FILTER:BREAST == 0
	PRINT [指定なし]
ELSEIF FILTER:BREAST == 1
	PRINT [絶壁]
ELSEIF FILTER:BREAST == 2
	PRINT [貧乳]
ELSEIF FILTER:BREAST == 3
	PRINT [並乳]
ELSEIF FILTER:BREAST == 4
	PRINT [巨乳]
ELSEIF FILTER:BREAST == 5
	PRINT [爆乳]
ENDIF

PRINTL
PRINT 処女: 
IF FILTER:VERGIN == 0
	SETCOLOR 0X666666
	PRINT [指定なし]
	RESETCOLOR
ELSE
	PRINTBUTTON "[指定なし]", 0
ENDIF
PRINT 　
IF FILTER:VERGIN == 1
	SETCOLOR 0X666666
	PRINT [処女]
	RESETCOLOR
ELSE
	PRINTBUTTON "[処女]", 1
ENDIF
PRINT 　
IF FILTER:VERGIN == 2
	SETCOLOR 0X666666
	PRINT [非処女]
	RESETCOLOR
ELSE
	PRINTBUTTON "[非処女]", 2
ENDIF
PRINTL

PRINT 胸のサイズ: 
IF FILTER:BREAST == 0
	SETCOLOR 0X666666
	PRINT [指定なし]
	RESETCOLOR
ELSE
	PRINTBUTTON "[指定なし]", 10
ENDIF
IF FILTER:BREAST == 1
	SETCOLOR 0X666666
	PRINT [絶壁]
	RESETCOLOR
ELSE
	PRINTBUTTON "[絶壁]", 11
ENDIF
PRINT 　
IF FILTER:BREAST == 2
	SETCOLOR 0X666666
	PRINT [貧乳]
	RESETCOLOR
ELSE
	PRINTBUTTON "[貧乳]", 12
ENDIF
PRINT 　
IF FILTER:BREAST == 3
	SETCOLOR 0X666666
	PRINT [並乳]
	RESETCOLOR
ELSE
	PRINTBUTTON "[並乳]", 13
ENDIF
PRINT 　
IF FILTER:BREAST == 4
	SETCOLOR 0X666666
	PRINT [巨乳]
	RESETCOLOR
ELSE
	PRINTBUTTON "[巨乳]", 14
ENDIF
PRINT 　
IF FILTER:BREAST == 5
	SETCOLOR 0X666666
	PRINT [爆乳]
	RESETCOLOR
ELSE
	PRINTBUTTON "[爆乳]", 15
ENDIF
PRINTL

PRINTBUTTON "[決定]", 9

INPUT
IF RESULT == 0
	FILTER:VERGIN = 0
ELSEIF RESULT == 1
	FILTER:VERGIN = 1
ELSEIF RESULT == 2
	FILTER:VERGIN = 2
ELSEIF RESULT == 10
	FILTER:BREAST = 0
ELSEIF RESULT == 11
	FILTER:BREAST = 1
ELSEIF RESULT == 12
	FILTER:BREAST = 2
ELSEIF RESULT == 13
	FILTER:BREAST = 3
ELSEIF RESULT == 14
	FILTER:BREAST = 4
ELSEIF RESULT == 15
	FILTER:BREAST = 5
ELSEIF RESULT == 9
	RETURN
ENDIF

GOTO INPUT_LOOP

; ソフトフィルターの結果を反映
@UPDATE_BY_SOFT_FILTER(ID, FILTER)
#DIM ID
#DIM REF FILTER
#DIM CONST VERGIN = 0
#DIM CONST BREAST = 1


IF FILTER:VERGIN == 1
	TALENT:ID:処女 = 1
	EXP:ID:Ｖ経験 = 0
	EXP:ID:性交経験 = 0
	EXP:ID:膣射経験 = 0
	ABL:ID:Ｖ感覚 = 0
ENDIF	

SIF FILTER:BREAST != 0
	CALL SET_BREAST_SIZE(ID, FILTER:BREAST - 3)

@DETAIL_FILTER(FILTER)
#DIM REF FILTER
#DIM SELECTED
#DIM TOTAL_PRICE

$INPUT_LOOP
PRINTL 選択済みの素質を再度選択すると、選択を解除できます
PRINT 値段: 
CALL GET_PRICE_FROM_FILTER(FILTER)
TOTAL_PRICE = 1000 + RESULT
PRINTFORML %TOSTR(TOTAL_PRICE, "$###,###")%
PRINT 性経験
IF FILTER:2 == 0
	PRINT [指定なし]
ELSE
	SETCOLOR 0X666666
	PRINTBUTTON "[指定なし]", 300
	RESETCOLOR
ENDIF
PRINT 　
IF FILTER:2 == 1
	PRINT [自慰まで許容]
ELSE
	SETCOLOR 0X666666
	PRINTBUTTON "[自慰まで許容]", 301
	RESETCOLOR
ENDIF
PRINT
IF FILTER:2 == 2
	PRINT [全て許容]
ELSE
	SETCOLOR 0X666666
	PRINTBUTTON "[全て許容]", 302
	RESETCOLOR
ENDIF
PRINTL
FOR LOCAL, 0, 145
	SIF TALENTNAME:LOCAL == ""
		CONTINUE
	SIF LOCAL > 2 && LOCAL < 10
		CONTINUE
	SIF LOCAL == 37 || LOCAL == 73 || LOCAL == 74 || LOCAL == 75 || LOCAL == 76 || LOCAL == 77 || LOCAL == 85 || LOCAL == 86 || LOCAL == 90 || LOCAL == 91 || LOCAL == 100 || LOCAL == 132 || LOCAL == 133 || LOCAL == 134 || LOCAL == 137 || LOCAL == 138 || LOCAL == 140 || LOCAL == 142 || LOCAL == 143 || LOCAL == 144
		CONTINUE
	LOCALS = [%TALENTNAME:LOCAL%]
	;]
	IF FILTER:LOCAL == 1
		PRINTBUTTON @"%LOCALS, 14, LEFT%", LOCAL + 100
	ELSEIF FILTER:LOCAL == 0
		SETCOLOR 0X666666
		PRINTBUTTON @"%LOCALS, 14, LEFT%", LOCAL + 100
		RESETCOLOR
	ENDIF
NEXT
PRINTL

PRINTBUTTON "[決定]", 999

INPUT
SIF RESULT == 999
	RETURN TOTAL_PRICE
IF RESULT == 300
	FILTER:2 = 0
	GOTO INPUT_LOOP
ELSEIF RESULT == 301
	FILTER:2 = 1
	GOTO INPUT_LOOP
ELSEIF RESULT == 302
	FILTER:2 = 2
	GOTO INPUT_LOOP
ENDIF
SELECTED = RESULT - 100
; 選択不可能な要素が選ばれていた場合
SIF SELECTED > 2 && SELECTED < 10
	GOTO INPUT_LOOP
SIF SELECTED == 37 || SELECTED == 73 || SELECTED == 74 || SELECTED == 75 || SELECTED == 76 || SELECTED == 77 || SELECTED == 85 || SELECTED == 86 || SELECTED == 90 || SELECTED == 91 || SELECTED == 100 || SELECTED == 132 || SELECTED == 133 || SELECTED == 134 || SELECTED == 137 || SELECTED == 138 || SELECTED == 140 || SELECTED == 142 || SELECTED == 143 || SELECTED == 144
	GOTO INPUT_LOOP

; トグル
IF FILTER:SELECTED == 1
	FILTER:SELECTED = 0
	GOTO INPUT_LOOP
ELSE
	FILTER:SELECTED = 1
ENDIF
; 相反する要素がある場合
SELECTCASE SELECTED
	CASE 0
		FILTER:1 = 0
	CASE 1
		FILTER:0 = 0
	CASE 11
		FILTER:13 = 0
	CASE 12
		FILTER:13 = 0
	CASE 13
		FILTER:11 = 0
		FILTER:12 = 0
	CASE 15
		FILTER:17 = 0
	CASE 17
		FILTER:15 = 0
	CASE 23
		FILTER:24 = 0
	CASE 24
		FILTER:23 = 0
	CASE 25
		FILTER:26 = 0
	CASE 26
		FILTER:25 = 0
	CASE 30
		FILTER:31 = 0
	CASE 31
		FILTER:30 = 0
	CASE 32
		FILTER:33 = 0
	CASE 33
		FILTER:32 = 0
	CASE 35
		FILTER:36 = 0
	CASE 36
		FILTER:35 = 0
	CASE 40
		FILTER:41 = 0
	CASE 41
		FILTER:40 = 0
	CASE 42
		FILTER:43 = 0
	CASE 43
		FILTER:42 = 0
	CASE 50
		FILTER:51 = 0
	CASE 51
		FILTER:50 = 0
	CASE 61
		FILTER:62 = 0
		FILTER:64 = 0
	CASE 62
		FILTER:61 = 0
		FILTER:64 = 0
	CASE 64
		FILTER:61 = 0
		FILTER:62 = 0
	CASE 70
		FILTER:71 = 0
	CASE 71
		FILTER:70 = 0
	CASE 101
		FILTER:102 = 0
	CASE 102
		FILTER:101 = 0
	CASE 103
		FILTER:104 = 0
	CASE 104
		FILTER:103 = 0
	CASE 105
		FILTER:106 = 0
	CASE 106
		FILTER:105 = 0
	CASE 107
		FILTER:108 = 0
	CASE 108
		FILTER:107 = 0
	CASE 109
		FILTER:110 = 0
		FILTER:111 = 0
		FILTER:112 = 0
	CASE 110
		FILTER:109 = 0
		FILTER:111 = 0
		FILTER:112 = 0
	CASE 111
		FILTER:109 = 0
		FILTER:110 = 0
		FILTER:112 = 0
	CASE 112
		FILTER:109 = 0
		FILTER:110 = 0
		FILTER:111 = 0
	CASE 130
		FILTER:131 = 0
	CASE 131
		FILTER:130 = 0
ENDSELECT
GOTO INPUT_LOOP

; 詳細フィルターの結果を反映
@UPDATE_BY_DETAIL_FILTER(ID, FILTER)
#DIM ID
#DIM REF FILTER
#DIM CONST VERGIN = 0
#DIM CONST BREAST = 1


FOR LOCAL, 0, 145
	IF LOCAL == 2
		SIF FILTER:2 == 0
			CONTINUE
		IF FILTER:2 == 1
			EXP:ID:絶頂経験 = RAND:30
			EXP:ID:自慰経験 = RAND:30 + 30
			EXP:ID:Ｖ経験 = 0
			EXP:ID:Ａ経験 = 0
			EXP:ID:性交経験 = 0
			EXP:ID:膣射経験 = 0
			EXP:ID:精液経験 = 0
			EXP:ID:フェラ経験 = 0
			ABL:ID:従順 = 0
			ABL:ID:欲望 = 0
			ABL:ID:技巧 = 0
			ABL:ID:Ｃ感覚 = 0
			ABL:ID:Ｂ感覚 = 0
			ABL:ID:Ｖ感覚 = 0
			ABL:ID:Ａ感覚 = 0
			TALENT:ID:処女 = 1
			CONTINUE
		ELSE
			CONTINUE
		ENDIF
	ENDIF
	IF FILTER:LOCAL == 1
		TALENT:ID:LOCAL = 1
		; 相反する要素がある場合
		SELECTCASE LOCAL
			CASE 0
				TALENT:ID:1 = 0
			CASE 1
				TALENT:ID:0 = 0
			CASE 11
				TALENT:ID:13 = 0
			CASE 12
				TALENT:ID:13 = 0
			CASE 13
				TALENT:ID:11 = 0
				TALENT:ID:12 = 0
			CASE 15
				TALENT:ID:17 = 0
			CASE 17
				TALENT:ID:15 = 0
			CASE 23
				TALENT:ID:24 = 0
			CASE 24
				TALENT:ID:23 = 0
			CASE 25
				TALENT:ID:26 = 0
			CASE 26
				TALENT:ID:25 = 0
			CASE 30
				TALENT:ID:31 = 0
			CASE 31
				TALENT:ID:30 = 0
			CASE 32
				TALENT:ID:33 = 0
			CASE 33
				TALENT:ID:32 = 0
			CASE 35
				TALENT:ID:36 = 0
			CASE 36
				TALENT:ID:35 = 0
			CASE 40
				TALENT:ID:41 = 0
			CASE 41
				TALENT:ID:40 = 0
			CASE 42
				TALENT:ID:43 = 0
			CASE 43
				TALENT:ID:42 = 0
			CASE 50
				TALENT:ID:51 = 0
			CASE 51
				TALENT:ID:50 = 0
			CASE 61
				TALENT:ID:62 = 0
				TALENT:ID:64 = 0
			CASE 62
				TALENT:ID:61 = 0
				TALENT:ID:64 = 0
			CASE 64
				TALENT:ID:61 = 0
				TALENT:ID:62 = 0
			CASE 70
				TALENT:ID:71 = 0
			CASE 71
				TALENT:ID:70 = 0
			CASE 101
				TALENT:ID:102 = 0
			CASE 102
				TALENT:ID:101 = 0
			CASE 103
				TALENT:ID:104 = 0
			CASE 104
				TALENT:ID:103 = 0
			CASE 105
				TALENT:ID:106 = 0
			CASE 106
				TALENT:ID:105 = 0
			CASE 107
				TALENT:ID:108 = 0
			CASE 108
				TALENT:ID:107 = 0
			CASE 109
				TALENT:ID:110 = 0
				TALENT:ID:111 = 0
				TALENT:ID:112 = 0
			CASE 110
				TALENT:ID:109 = 0
				TALENT:ID:111 = 0
				TALENT:ID:112 = 0
			CASE 111
				TALENT:ID:109 = 0
				TALENT:ID:110 = 0
				TALENT:ID:112 = 0
			CASE 112
				TALENT:ID:109 = 0
				TALENT:ID:110 = 0
				TALENT:ID:111 = 0
			CASE 130
				TALENT:ID:131 = 0
			CASE 131
				TALENT:ID:130 = 0
		ENDSELECT
	ENDIF
NEXT

@GET_PRICE_FROM_FILTER(FILTER)
#DIM REF FILTER
#DIM TOTAL_PRICE

TOTAL_PRICE = 0

FOR LOCAL, 0, 145
	SIF FILTER:LOCAL != 0
		TOTAL_PRICE += 5000
NEXT
RETURN TOTAL_PRICE

@SELECT_EMPLOY_TYPE(ID)
#DIM ID

$INPUT_LOOP
PRINTFORML %CALLNAME:ID%をどのように扱いますか？
PRINTBUTTON "[0] 性奴隷として扱う", 0
PRINTL
PRINTBUTTON "[1] 士官として採用する", 1
INPUT
IF RESULT == 0
	CALL ASK_YN("性奴隷として扱う、でよろしいですか？")
	IF RESULT == 1
		CFLAG:ID:1015 = 0
	ELSE
		GOTO INPUT_LOOP
	ENDIF
ELSEIF RESULT == 1
	CALL ASK_YN("士官として採用する、でよろしいですか？")
	IF RESULT == 1
		CFLAG:ID:1015 = 1
	ELSE
		GOTO INPUT_LOOP
	ENDIF
ELSE
	GOTO INPUT_LOOP
ENDIF
RETURN CFLAG:ID:1015