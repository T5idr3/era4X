;-------------------------------------------------
;バイブなど付けっぱなしアイテムのチェック
;-------------------------------------------------
@EQUIP_CHECK
;着衣の処理
CALL EQUIP_CLOTHES

;クリキャップ装着中
SIF TEQUIP:11
	CALL EQUIP_COM42

;オナホール装着中
SIF TEQUIP:12
	CALL EQUIP_COM43

;バイブ装着中
SIF TEQUIP:13
	CALL EQUIP_COM44

;アナルバイブ装着中
SIF TEQUIP:14
	CALL EQUIP_COM45

;アナルビーズ使用中
SIF TEQUIP:15
	CALL EQUIP_COM46

;ニプルキャップ装着中
SIF TEQUIP:16
	CALL EQUIP_COM47

;搾乳器装着中
SIF TEQUIP:17
	CALL EQUIP_COM49

;アイマスク装着中
SIF TEQUIP:18
	CALL EQUIP_COM105

;縄で緊縛中
SIF TEQUIP:19
	CALL EQUIP_COM106

;ボールギャグ装着中
SIF TEQUIP:20
	CALL EQUIP_COM107

;浣腸＋アナルプラグ装着中
SIF TEQUIP:21
	CALL EQUIP_COM146

;拡張バルーン装着中
SIF TEQUIP:22
	CALL EQUIP_COM148

;アナル電極装着中
SIF TEQUIP:23
	CALL EQUIP_COM149

;乳房電極装着中
SIF TEQUIP:24
	CALL EQUIP_COM150

;触手調教中
SIF TEQUIP:25
	CALL EQUIP_COM160

;ビデオ撮影中
SIF TEQUIP:28
	CALL EQUIP_COM183

;野外プレイ中
SIF TEQUIP:29
	CALL EQUIP_COM184

;羞恥プレイ中
SIF TEQUIP:30
	CALL EQUIP_COM186

;お風呂場プレイ中
SIF TEQUIP:31
	CALL EQUIP_COM187

;シャワー使用中
SIF TEQUIP:32
	CALL EQUIP_COM188

;新妻プレイ中
SIF TEQUIP:33
	CALL EQUIP_COM189

;強精神薬の効果発揮中／強精神薬の反動処理
SIF TEQUIP:34
	CALL EQUIP_COM191

;触手口辱中
SIF TEQUIP:36
	CALL EQUIP_COM168

RETURN 1


;-------------------------------------------------
;主人による調教のボーナス
;-------------------------------------------------
@MASTER_SKILL_CHECK
;依存度ボーナス
IF ASSIPLAY == 0
	;正ベクトル
	IF CFLAG:2 >= 5000
		TIMES SOURCE:0 , 1.40
		TIMES SOURCE:1 , 1.40
		TIMES SOURCE:2 , 1.40
		TIMES SOURCE:3 , 1.40
		TIMES SOURCE:4 , 1.50
		
		TIMES SOURCE:15 , 0.50
		TIMES SOURCE:17 , 0.50
	ELSEIF CFLAG:2 >= 2000
		TIMES SOURCE:0 , 1.20
		TIMES SOURCE:1 , 1.20
		TIMES SOURCE:2 , 1.20
		TIMES SOURCE:3 , 1.20
		TIMES SOURCE:4 , 1.30
		
		TIMES SOURCE:15 , 0.70
		TIMES SOURCE:17 , 0.70
	ELSEIF CFLAG:2 >= 1000
		TIMES SOURCE:0 , 1.10
		TIMES SOURCE:1 , 1.10
		TIMES SOURCE:2 , 1.10
		TIMES SOURCE:3 , 1.10
		TIMES SOURCE:4 , 1.20
		
		TIMES SOURCE:15 , 0.80
		TIMES SOURCE:17 , 0.80
	ELSEIF CFLAG:2 >= 500
		TIMES SOURCE:4 , 1.10
		
		TIMES SOURCE:15 , 0.90
		TIMES SOURCE:17 , 0.90
	;負ベクトル
	ELSEIF CFLAG:2 <= -5000
		TIMES SOURCE:8 , 1.40
		TIMES SOURCE:9 , 1.40
		TIMES SOURCE:14 , 1.50
		
		TIMES SOURCE:16 , 0.50
		TIMES SOURCE:18 , 0.50
	ELSEIF CFLAG:2 <= -2000
		TIMES SOURCE:8 , 1.20
		TIMES SOURCE:9 , 1.20
		TIMES SOURCE:14 , 1.30
		
		TIMES SOURCE:16 , 0.70
		TIMES SOURCE:18 , 0.70
	ELSEIF CFLAG:2 <= -1000
		TIMES SOURCE:8 , 1.10
		TIMES SOURCE:9 , 1.10
		TIMES SOURCE:14 , 1.20
		
		TIMES SOURCE:16 , 0.80
		TIMES SOURCE:18 , 0.80
	ELSEIF CFLAG:2 <= -500
		TIMES SOURCE:14 , 1.10
		
		TIMES SOURCE:16 , 0.90
		TIMES SOURCE:18 , 0.90
	ENDIF
ENDIF

;-------------------------------------------------
;処女喪失時の処理
;-------------------------------------------------
@LOST_VIRGIN
IF TALENT:処女 && TFLAG:19
	PRINTW 処女喪失
	TALENT:処女 = 0
	;処女喪失フラグ(今回のコマンド)
	TFLAG:3 = 1
	;処女喪失フラグ(今回の調教)
	TFLAG:31 = 1
	;処女喪失フラグ(ビデオ撮影)
	SIF TEQUIP:28
		TFLAG:39 = 1
	;貞操観念+恋慕or親愛（主人による処女喪失のみ）
	IF TALENT:貞操観念 && TFLAG:19 && (TALENT:恋慕 == 0 && TALENT:親愛 == 0)
		TIMES SOURCE:4 , 1.20
		TIMES SOURCE:18 , 0.50
	;貞操観念
	ELSEIF TALENT:貞操観念
		TIMES SOURCE:4 , 0.60
		TIMES SOURCE:18 , 10.00
	;貞操無頓着
	ELSEIF TALENT:貞操無頓着
		TIMES SOURCE:4 , 0.60
		TIMES SOURCE:18 , 0.50
	ENDIF
	;指挿入れの慣らしギミック処理
	IF PALAM:1 >= 80
		TIMES SOURCE:1 , 1.50
		TIMES SOURCE:4 , 1.20
		TIMES SOURCE:7 , 0.80
		TIMES SOURCE:18 , 0.80
	ELSEIF PALAM:1 >= 60
		TIMES SOURCE:1 , 1.40
		TIMES SOURCE:4 , 1.15
		TIMES SOURCE:7 , 0.85
		TIMES SOURCE:18 , 0.85
	ELSEIF PALAM:1 >= 40
		TIMES SOURCE:1 , 1.30
		TIMES SOURCE:4 , 1.10
		TIMES SOURCE:7 , 0.90
		TIMES SOURCE:18 , 0.90
	ELSEIF PALAM:1 >= 20
		TIMES SOURCE:1 , 1.20
		TIMES SOURCE:4 , 1.05
		TIMES SOURCE:7 , 0.95
		TIMES SOURCE:18 , 0.95
	ENDIF
	;陥落素質による処理
	IF TFLAG:20
		;恋慕かつ相手が主人
		IF TALENT:恋慕 && TFLAG:20
			PRINTFORML %CALLNAME:TARGET%は%CALLNAME:MASTER%に処女を捧げられた事に幸福を感じているようだ……
			TFLAG:150 = 2
			TIMES SOURCE:4 , 2.00
			TIMES SOURCE:18 , 0.30
		;親愛かつ相手が主人
		ELSEIF TALENT:親愛 && TFLAG:20
			PRINTFORML %CALLNAME:TARGET%は%CALLNAME:MASTER%が初めての相手である事にこの上ない幸せを感じているようだ……
			TFLAG:150 = 2
			TIMES SOURCE:4 , 2.00
			TIMES SOURCE:18 , 0.10
		ENDIF
		;行為によって、愛情経験を加算する
		;正常位
		IF SELECTCOM == 60
			PRINTFORML %EXPNAME:23%+10
			EXP:愛情経験 += 10
		;後背位
		ELSEIF SELECTCOM == 61
			PRINTFORML %EXPNAME:23%+5
			EXP:愛情経験 += 5
		;騎乗位
		ELSEIF SELECTCOM == 66
			PRINTFORML %EXPNAME:23%+5
			EXP:愛情経験 += 5
		;対面座位
		ELSEIF SELECTCOM == 68
			PRINTFORML %EXPNAME:23%+8
			EXP:愛情経験 += 8
		;背面座位
		ELSEIF SELECTCOM == 69
			PRINTFORML %EXPNAME:23%+5
			EXP:愛情経験 += 5
		;３Ｐ
		ELSEIF SELECTCOM == 500
			PRINTFORML %EXPNAME:23%+5
			EXP:愛情経験 += 5
		;乱れ牡丹
		ELSEIF SELECTCOM == 504
			PRINTFORML %EXPNAME:23%+5
			EXP:愛情経験 += 5
		;騎乗乳房自慰
		ELSEIF SELECTCOM == 505
			PRINTFORML %EXPNAME:23%+5
			EXP:愛情経験 += 5
		ENDIF
	ENDIF
ENDIF

;-------------------------------------------------
;再生処女喪失のチェック
;-------------------------------------------------
IF TALENT:再生処女 && TFLAG:19
	PRINTW 再生処女喪失
	TALENT:再生処女 = 0
	;指挿入れの慣らしギミック処理
	IF PALAM:1 >= 80
		TIMES SOURCE:7 , 0.80
	ELSEIF PALAM:1 >= 60
		TIMES SOURCE:7 , 0.85
	ELSEIF PALAM:1 >= 40
		TIMES SOURCE:7 , 0.90
	ELSEIF PALAM:1 >= 20
		TIMES SOURCE:7 , 0.95
	ENDIF
ENDIF



;-------------------------------------------------
;技巧のチェック
;-------------------------------------------------
@TECHNIQUE_CHECK
;行為をしている者の技巧をチェックする
;奴隷の場合
IF TFLAG:28 == 1
	;奴隷のABL:技巧
	IF ABL:2 == 0
		TIMES SOURCE:0 , 0.50
		TIMES SOURCE:1 , 0.50
		TIMES SOURCE:2 , 0.50
		TIMES SOURCE:3 , 0.50
		TIMES SOURCE:5 , 0.50
	ELSEIF ABL:2 == 1
		TIMES SOURCE:0 , 0.60
		TIMES SOURCE:1 , 0.60
		TIMES SOURCE:2 , 0.60
		TIMES SOURCE:3 , 0.60
		TIMES SOURCE:5 , 0.55
	ELSEIF ABL:2 == 2
		TIMES SOURCE:0 , 0.80
		TIMES SOURCE:1 , 0.80
		TIMES SOURCE:2 , 0.80
		TIMES SOURCE:3 , 0.80
		TIMES SOURCE:5 , 0.70
	ELSEIF ABL:2 == 3
		TIMES SOURCE:0 , 1.00
		TIMES SOURCE:1 , 1.00
		TIMES SOURCE:2 , 1.00
		TIMES SOURCE:3 , 1.00
		TIMES SOURCE:5 , 0.90
	ELSEIF ABL:2 == 4
		TIMES SOURCE:0 , 1.20
		TIMES SOURCE:1 , 1.20
		TIMES SOURCE:2 , 1.20
		TIMES SOURCE:3 , 1.20
		TIMES SOURCE:5 , 1.20
	ELSEIF ABL:2 == 5
		TIMES SOURCE:0 , 1.50
		TIMES SOURCE:1 , 1.50
		TIMES SOURCE:2 , 1.50
		TIMES SOURCE:3 , 1.50
		TIMES SOURCE:5 , 1.50
	ELSEIF ABL:2 == 6
		TIMES SOURCE:0 , 1.80
		TIMES SOURCE:1 , 1.80
		TIMES SOURCE:2 , 1.80
		TIMES SOURCE:3 , 1.80
		TIMES SOURCE:5 , 1.80
	ELSEIF ABL:2 == 7
		TIMES SOURCE:0 , 2.50
		TIMES SOURCE:1 , 2.50
		TIMES SOURCE:2 , 2.50
		TIMES SOURCE:3 , 2.50
		TIMES SOURCE:5 , 2.50
	ELSEIF ABL:2 == 8
		TIMES SOURCE:0 , 3.00
		TIMES SOURCE:1 , 3.00
		TIMES SOURCE:2 , 3.00
		TIMES SOURCE:3 , 3.00
		TIMES SOURCE:5 , 3.00
	ELSEIF ABL:2 == 9
		TIMES SOURCE:0 , 3.50
		TIMES SOURCE:1 , 3.50
		TIMES SOURCE:2 , 3.50
		TIMES SOURCE:3 , 3.50
		TIMES SOURCE:5 , 3.50
	ELSEIF ABL:2 == 10
		TIMES SOURCE:0 , 5.00
		TIMES SOURCE:1 , 5.00
		TIMES SOURCE:2 , 5.00
		TIMES SOURCE:3 , 5.00
		TIMES SOURCE:5 , 5.00
	ENDIF
;調教者の場合
ELSEIF TFLAG:28 == 0
;調教者のABL:技巧
	IF ABL:PLAYER:2 == 0
		TIMES SOURCE:0 , 0.50
		TIMES SOURCE:1 , 0.50
		TIMES SOURCE:2 , 0.50
		TIMES SOURCE:3 , 0.50
	ELSEIF ABL:PLAYER:2 == 1
		TIMES SOURCE:0 , 0.60
		TIMES SOURCE:1 , 0.60
		TIMES SOURCE:2 , 0.60
		TIMES SOURCE:3 , 0.60
	ELSEIF ABL:PLAYER:2 == 2
		TIMES SOURCE:0 , 0.80
		TIMES SOURCE:1 , 0.80
		TIMES SOURCE:2 , 0.80
		TIMES SOURCE:3 , 0.80
	ELSEIF ABL:PLAYER:2 == 3
		TIMES SOURCE:0 , 1.00
		TIMES SOURCE:1 , 1.00
		TIMES SOURCE:2 , 1.00
		TIMES SOURCE:3 , 1.00
	ELSEIF ABL:PLAYER:2 == 4
		TIMES SOURCE:0 , 1.20
		TIMES SOURCE:1 , 1.20
		TIMES SOURCE:2 , 1.20
		TIMES SOURCE:3 , 1.20
	ELSEIF ABL:PLAYER:2 == 5
		TIMES SOURCE:0 , 1.50
		TIMES SOURCE:1 , 1.50
		TIMES SOURCE:2 , 1.50
		TIMES SOURCE:3 , 1.50
	ELSEIF ABL:PLAYER:2 == 6
		TIMES SOURCE:0 , 1.80
		TIMES SOURCE:1 , 1.80
		TIMES SOURCE:2 , 1.80
		TIMES SOURCE:3 , 1.80
	ELSEIF ABL:PLAYER:2 == 7
		TIMES SOURCE:0 , 2.50
		TIMES SOURCE:1 , 2.50
		TIMES SOURCE:2 , 2.50
		TIMES SOURCE:3 , 2.50
	ELSEIF ABL:PLAYER:2 == 8
		TIMES SOURCE:0 , 3.00
		TIMES SOURCE:1 , 3.00
		TIMES SOURCE:2 , 3.00
		TIMES SOURCE:3 , 3.00
	ELSEIF ABL:PLAYER:2 == 9
		TIMES SOURCE:0 , 3.50
		TIMES SOURCE:1 , 3.50
		TIMES SOURCE:2 , 3.50
		TIMES SOURCE:3 , 3.50
	ELSEIF ABL:PLAYER:2 == 10
		TIMES SOURCE:0 , 5.00
		TIMES SOURCE:1 , 5.00
		TIMES SOURCE:2 , 5.00
		TIMES SOURCE:3 , 5.00
	ENDIF
	EXP:PLAYER:調教経験 += 1
ENDIF


;-------------------------------------------------
;強精神薬による絶頂キャンセル
;-------------------------------------------------
@ECST_CANCEL

;SOURCE.ERBの絶頂処理を流用

C = 0
V = 0
A = 0
B = 0

;絶頂Ｃ
IF UP:0 + PALAM:0 >= PALAMLV:4 * 2
	C = 2
	DOWN:0 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｃキャンセル
ELSEIF UP:0 + PALAM:0 >= PALAMLV:4
	C = 1
	PALAM:0 = 5000
	UP:0 = 0
	PRINTL 絶頂Ｃキャンセル
ENDIF
;DOWN:1で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:0 + PALAM:0 - DOWN:0 >= PALAMLV:4
	DOWN:0 = UP:0 + PALAM:0 - PALAMLV:4 + 1

;絶頂Ｖ
IF UP:1 + PALAM:1 >= PALAMLV:4 * 2
	DOWN:1 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｖキャンセル
ELSEIF UP:1 + PALAM:1 >= PALAMLV:4
	V = 1
	DOWN:1 = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ｖキャンセル
ENDIF
;DOWN:1で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:1 + PALAM:1 - DOWN:1 >= PALAMLV:4
	DOWN:1 = UP:1 + PALAM:1 - PALAMLV:4 + 1

;絶頂Ａ
IF UP:2 + PALAM:2 >= PALAMLV:4 * 2
	A = 2
	DOWN:2 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ａキャンセル
ELSEIF UP:2 + PALAM:2 >= PALAMLV:4
	A = 1
	DOWN:2 = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ａキャンセル
ENDIF
;DOWN:2で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:2 + PALAM:2 - DOWN:2 >= PALAMLV:4
	DOWN:2 = UP:2 + PALAM:2 - PALAMLV:4 + 1

;絶頂Ｂ
IF UP:3 + PALAM:3 >= PALAMLV:4 * 2
	B = 2
	DOWN:3 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｂキャンセル
ELSEIF UP:3 + PALAM:3 >= PALAMLV:4
	B = 1
	DOWN:3 = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ｂキャンセル
ENDIF
;DOWN:3で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:3 + PALAM:3 - DOWN:3 >= PALAMLV:4
	DOWN:3 = UP:3 + PALAM:3 - PALAMLV:4 + 1
	
;止められた絶頂回数をTFLAG:44～TFLAG:47に記録
TFLAG:44 += C
TFLAG:45 += V
TFLAG:46 += A
TFLAG:47 += B

RETURN 1

;-------------------------------------------------
;絶頂処理
;-------------------------------------------------
@ORGASM_ADD
C = 0
V = 0
A = 0
B = 0

;強精神薬の副作用を適用する
IF TEQUIP:34 == 1
	CALL REACT_DRUG
ENDIF

;絶頂Ｃ
IF UP:0 + PALAM:0 >= PALAMLV:4 * 2
	C = 2
	DOWN:0 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｃ
ELSEIF UP:0 + PALAM:0 >= PALAMLV:4
	C = 1
	DOWN:0 = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ｃ
ENDIF
;DOWN:0で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:0 + PALAM:0 - DOWN:0 >= PALAMLV:4
	DOWN:0 = UP:0 + PALAM:0 - PALAMLV:4 + 1

;絶頂Ｖ
IF UP:1 + PALAM:1 >= PALAMLV:4 * 2
	V = 2
	DOWN:1 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｖ
ELSEIF UP:1 + PALAM:1 >= PALAMLV:4
	V = 1
	DOWN:1 = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ｖ
ENDIF
;DOWN:1で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:1 + PALAM:1 - DOWN:1 >= PALAMLV:4
	DOWN:1 = UP:1 + PALAM:1 - PALAMLV:4 + 1

;絶頂Ａ
IF UP:2 + PALAM:2 >= PALAMLV:4 * 2
	A = 2
	DOWN:2 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ａ
ELSEIF UP:2 + PALAM:2 >= PALAMLV:4
	A = 1
	DOWN:2 = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ａ
ENDIF
;DOWN:2で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:2 + PALAM:2 - DOWN:2 >= PALAMLV:4
	DOWN:2 = UP:2 + PALAM:2 - PALAMLV:4 + 1

;絶頂Ｂ
IF UP:3 + PALAM:3 >= PALAMLV:4 * 2
	B = 2
	DOWN:3 = (PALAMLV:4 * 2 - 1000)
	PRINTL 強絶頂Ｂ
ELSEIF UP:3 + PALAM:3 >= PALAMLV:4
	B = 1
	DOWN:3 = (PALAMLV:4 - 1000)
	PRINTL 絶頂Ｂ
ENDIF
;DOWN:3で下げても絶頂以上なら
;その値-1になるように調整（10000で絶頂なら9999）
SIF UP:3 + PALAM:3 - DOWN:3 >= PALAMLV:4
	DOWN:3 = UP:3 + PALAM:3 - PALAMLV:4 + 1

;-------------------------------------------------
;絶頂時の追加処理
;-------------------------------------------------
TFLAG:29 = C + V + A + B

;快楽刻印の処理
;絶頂の部位と強度の合計が一定以上で刻印を取得する
R = C+V*2+A*2+B
;Rが4以上で快楽刻印３に相当
IF R >= 4 && MARK:1 < 3
	TFLAG:200 = 3
;Rが3以上で快楽刻印２に相当
ELSEIF R >= 3 && MARK:1 < 2
	TFLAG:200 = 2
;Rが2以上で快楽刻印１に相当
ELSEIF R >= 2 && MARK:1 < 1
	TFLAG:200 = 1
ENDIF

IF C && V && A && B
	PRINTL 四 重 絶 頂
	PRINTL (それぞれ8倍の珠が得られます)
	C *= 8
	V *= 8
	A *= 8
	B *= 8
ELSEIF C && V && A
	PRINTL Ｃ＆Ｖ＆Ａ絶頂
	PRINTL (それぞれ4倍の珠が得られます)
	C *= 4
	V *= 4
	A *= 4
ELSEIF B && V && A
	PRINTL Ｂ＆Ｖ＆Ａ絶頂
	PRINTL (それぞれ4倍の珠が得られます)
	B *= 4
	V *= 4
	A *= 4
ELSEIF C && B && A
	PRINTL Ｃ＆Ｂ＆Ａ絶頂
	PRINTL (それぞれ4倍の珠が得られます)
	C *= 4
	B *= 4
	A *= 4
ELSEIF C && V && B
	PRINTL Ｃ＆Ｖ＆Ｂ絶頂
	PRINTL (それぞれ4倍の珠が得られます)
	C *= 4
	V *= 4
	B *= 4
ELSEIF C && V
	PRINTL Ｃ＆Ｖ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	C *= 2
	V *= 2
ELSEIF C && A
	PRINTL Ｃ＆Ａ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	C *= 2
	A *= 2
ELSEIF V && A
	PRINTL Ｖ＆Ａ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	V *= 2
	A *= 2
ELSEIF C && B
	PRINTL Ｃ＆Ｂ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	C *= 2
	B *= 2
ELSEIF V && B
	PRINTL Ｖ＆Ｂ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	V *= 2
	B *= 2
ELSEIF A && B
	PRINTL Ａ＆Ｂ絶頂
	PRINTL (それぞれ2倍の珠が得られます)
	A *= 2
	B *= 2
ENDIF


IF C
	SOURCE:13 += 500 * C
	SOURCE:14 += 200 * C
	SOURCE:18 += 150 * C
	LOSEBASE:0 += 20
	LOSEBASE:1 += 10
ENDIF
IF V
	SOURCE:11 += 800 * V
	SOURCE:12 += 500 * V
	SOURCE:13 += 700 * V
	SOURCE:14 += 400 * V
	SOURCE:18 += 300 * V
	LOSEBASE:0 += 40
	LOSEBASE:1 += 20
ENDIF
IF A
	SOURCE:11 += 500 * A
	SOURCE:12 += 700 * A
	SOURCE:13 += 900 * A
	SOURCE:14 += 500 * A
	SOURCE:18 += 400 * A
	LOSEBASE:0 += 60
	LOSEBASE:1 += 30
ENDIF
IF B
	SOURCE:13 += 500 * B
	SOURCE:14 += 200 * B
	SOURCE:18 += 150 * B
	LOSEBASE:0 += 20
	LOSEBASE:1 += 10
ENDIF

;絶頂による欲望ＬＶアップ
L = 0
SIF C >= 2 || B >= 2 || V || A
	L = 1
SIF V >= 2 || A >= 2
	L = 2
SIF (C >= 2 && B >= 2) || (C >= 2 && V) || (C >= 2 && A) || (B >= 2 && V) || (B >= 2 && A) && (V && A)
	L = 2
SIF (C && B && V) || (C && B && A) || (C && V && A) || (V && A && B)
	L = 3
SIF C && V && A && B
	L = 4
;自制心があると１下がる
SIF TALENT:自制心
	L -= 1

IF ABL:1 < L
	ABL:1 = L
	PRINT そして
	PRINTS ABLNAME:1
	PRINT がLV
	PRINTV L
	PRINTL になった
	;欲望の上昇による[抑圧]の消滅をチェック
	CALL YOKUBO_UP_CHECK
ENDIF

;NOWEXにデータを入れる（絶頂時口上に使う）
NOWEX:0 = C
NOWEX:1 = V
NOWEX:2 = A
NOWEX:3 = B

;絶頂回数を増やす
EX:0 += C
EX:1 += V
EX:2 += A
EX:3 += B

;絶頂経験を増やす
EXP:絶頂経験 += C+V+A+B

RETURN 1

;-------------------------------------------------
;強精神薬の副作用
;-------------------------------------------------
@REACT_DRUG
;仕様説明：
;@ECST_CANCELでEX:11～EX:14に記録してきた絶頂回数を解放します。
;パッチ詰め合わせではTFLAG:44～TFLAG:47を代わりに使用。内訳は
;TFLAG:44 = EX:11(Ｃ絶頂処理)の代わり、TFLAG:45 = EX:12(Ｖ絶頂処理)の代わり、
;TFLAG:46 = EX:13(Ａ絶頂処理)の代わり、TFLAG:47 = EX:14(Ｂ絶頂処理)の代わり
;記録してきた絶頂回数１回につき、該当する部位の快ソース（UP:0,1,2,3）を２倍にします。
;１回のコマンドでひとつの部位につき１回ずつこの倍化処理を行い、
;EX:11～EX:14の合計が０になったとき、反動が解除されます。
;-------------------------------------------------
;快Ｃの処理
IF TFLAG:44 > 0 && UP:0 > 0
	UP:0 *= 2
	TFLAG:44 -= 1
ENDIF
;快Ｖの処理
IF TFLAG:45 > 0 && UP:1 > 0
	UP:1 *= 2
	TFLAG:45 -= 1
ENDIF
;快Ａの処理
IF TFLAG:46 > 0 && UP:2 > 0
	UP:2 *= 2
	TFLAG:46 -= 1
ENDIF
;快Ｂの処理
IF TFLAG:47 > 0 && UP:3 > 0
	UP:3 *= 2
	TFLAG:47 -= 1
ENDIF
;反動の終了チェック
SIF TFLAG:44 + TFLAG:45 + TFLAG:46 + TFLAG:47 == 0
	TEQUIP:34 = 0

RETURN 1


;-------------------------------------------------
;調教対象の射精チェック
;-------------------------------------------------
@TARGET_EJAC_CHECK
SIF TALENT:ふたなり == 0 && TALENT:オトコ == 0
	RETURN 0

A = UP:0 + UP:1 + UP:2 + UP:3

;自制心
SIF TALENT:自制心
	A /= 2

;快感に素直
SIF TALENT:快感に素直
	TIMES A , 1.20

;快感の否定（淫乱、娼婦で無効）
SIF TALENT:快感の否定 && (TALENT:淫乱 == 0 && TALENT:娼婦 == 0)
	TIMES A , 0.80

;媚薬
SIF TEQUIP:26
	A *= 2

;利尿剤
SIF TEQUIP:27
	A /= 2

;射精の再装填期間中は射精ゲージの増加は20分の1に
SIF CFLAG:TARGET:24 > 0
	A /= 20

;射精の限界が来ている場合は、射精ゲージの増加はしない
IF CFLAG:TARGET:11 == 0
	A = 0
	BASE:2 = 0
ENDIF

BASE:2 += A

S = BASE:2
EJAC = MAXBASE:2

IF  S > EJAC * 2
	E = 2
ELSEIF S > EJAC
	E = 1
ELSE
	E = 0
ENDIF

;大量射精
IF E == 2
	LOSEBASE:0 += 20
	LOSEBASE:1 += 100

	IF EXP:射精経験 < EXPLV:1
		SOURCE:13 += 10000
		SOURCE:14 += 5000
		SOURCE:15 += 2000
	ELSEIF EXP:射精経験 < EXPLV:2
		SOURCE:13 += 5000
		SOURCE:14 += 3000
		SOURCE:15 += 1500
	ELSEIF EXP:射精経験 < EXPLV:3
		SOURCE:13 += 3000
		SOURCE:14 += 1500
		SOURCE:15 += 1000
	ELSEIF EXP:射精経験 < EXPLV:4
		SOURCE:13 += 1500
		SOURCE:14 += 800
		SOURCE:15 += 700
	ELSEIF EXP:射精経験 < EXPLV:5
		SOURCE:13 += 1000
		SOURCE:14 += 500
		SOURCE:15 += 400
	ELSE
		SOURCE:13 += 500
		SOURCE:14 += 300
	ENDIF

	PRINTS NAME:TARGET
	PRINTL 大量射精
	PRINTL 精液経験＋１
	PRINTL 射精経験＋２
	IF EXP:射精経験 == 0 && TALENT:オトコ == 0
		EXP:異常経験 += 1
		PRINTL 異常経験＋1
	ENDIF
	EXP:精液経験 += 1
	EXP:射精経験 += 2

	CALL IN_VAGINA_CHECK_T

	;Ｐに精液汚れ
	STAIN:2 |= 4

	BASE:2 -= EJAC*2
	SIF BASE:2 >= EJAC
		BASE:2 = EJAC-1

	;調教対象が射精フラグ
	TFLAG:10 = 2
	NOWEX:5 += 1
	EX:5 += 1
;通常の射精
ELSEIF E == 1
	LOSEBASE:1 += 40

	IF EXP:射精経験 < EXPLV:1
		SOURCE:13 += 5000
		SOURCE:14 += 2500
		SOURCE:15 += 900
	ELSEIF EXP:射精経験 < EXPLV:2
		SOURCE:13 += 2500
		SOURCE:14 += 2000
		SOURCE:15 += 700
	ELSEIF EXP:射精経験 < EXPLV:3
		SOURCE:13 += 1000
		SOURCE:14 += 800
		SOURCE:15 += 500
	ELSEIF EXP:射精経験 < EXPLV:4
		SOURCE:13 += 800
		SOURCE:14 += 600
		SOURCE:15 += 350
	ELSEIF EXP:射精経験 < EXPLV:5
		SOURCE:13 += 400
		SOURCE:14 += 400
		SOURCE:15 += 200
	ELSE
		SOURCE:13 += 200
		SOURCE:14 += 250
	ENDIF

	PRINTS NAME:TARGET
	PRINTL 射精
	PRINTL 射精経験＋１
	IF EXP:射精経験 == 0 && TALENT:オトコ == 0
		EXP:異常経験 += 1
		PRINTL 異常経験＋1
	ENDIF
	EXP:射精経験 += 1

	CALL IN_VAGINA_CHECK_T

	;Ｐに精液汚れ
	STAIN:2 |= 4

	BASE:2 -= EJAC
	SIF BASE:2 >= EJAC
		BASE:2 = EJAC-1

	;調教対象が射精フラグ
	TFLAG:10 = 1
	NOWEX:5 += 1
	EX:5 += 1
ENDIF

;射精には再装填の期間を設ける
;通常射精時
SIF E == 1
	CFLAG:TARGET:24 = 3
;大量射精時
SIF E == 2
	CFLAG:TARGET:24 = 5

;射精残弾減少
SIF E > 0
	CFLAG:TARGET:11 -= 1

;-------------------------------------------------
;調教対象の噴乳チェック
;-------------------------------------------------
@TARGET_MILK_CHECK
SIF TALENT:母乳体質 == 0
	RETURN 0

A = UP:0 / 5 + UP:1 / 5 + UP:2 / 5 + UP:3 * 3

;自制心
SIF TALENT:自制心
	A /= 2

;快感に素直
SIF TALENT:快感に素直
	TIMES A , 1.20

;快感の否定（淫乱、娼婦で無効）
SIF TALENT:快感の否定 && (TALENT:淫乱 == 0 && TALENT:娼婦 == 0)
	TIMES A , 0.80

;B敏感
SIF TALENT:Ｂ鈍感
	TIMES A , 1.20

;媚薬
SIF TEQUIP:26
	A *= 2

;利尿剤
SIF TEQUIP:27
	A /= 2

;調教者が幼児退行
SIF TALENT:PLAYER:幼児／幼児退行
	TIMES A , 1.20

;調教者が幼稚
SIF TALENT:PLAYER:幼稚
	TIMES A , 1.20

;貧乳
SIF TALENT:貧乳
	TIMES A , 0.50

;噴乳中毒のレベルを見る
IF ABL:19 == 0
	TIMES A , 1.00
ELSEIF ABL:19 == 1
	TIMES A , 1.05
ELSEIF ABL:19 == 2
	TIMES A , 1.10
ELSEIF ABL:19 == 3
	TIMES A , 1.20
ELSEIF ABL:19 == 4
	TIMES A , 1.30
ELSE
	TIMES A , 1.50
ENDIF

A = 500 + A / 2
BASE:3 += A

S = BASE:3
EJAC = MAXBASE:3

IF  S > EJAC * 2
	E = 2
ELSEIF S > EJAC
	E = 1
ELSE
	E = 0
ENDIF

;大量噴乳
IF E == 2
	LOSEBASE:0 += 20
	LOSEBASE:1 += 100

	IF EXP:噴乳経験 < EXPLV:1
		SOURCE:13 += 10000
		SOURCE:14 += 5000
		SOURCE:15 += 2000
	ELSEIF EXP:噴乳経験 < EXPLV:2
		SOURCE:13 += 5000
		SOURCE:14 += 3000
		SOURCE:15 += 1500
	ELSEIF EXP:噴乳経験 < EXPLV:3
		SOURCE:13 += 3000
		SOURCE:14 += 1500
		SOURCE:15 += 1000
	ELSEIF EXP:噴乳経験 < EXPLV:4
		SOURCE:13 += 1500
		SOURCE:14 += 800
		SOURCE:15 += 700
	ELSEIF EXP:噴乳経験 < EXPLV:5
		SOURCE:13 += 1000
		SOURCE:14 += 500
		SOURCE:15 += 400
	ELSE
		SOURCE:13 += 500
		SOURCE:14 += 300
	ENDIF

	PRINTFORML %NAME:TARGET%は乳首から大量の母乳を噴出した
	PRINTL 噴乳経験＋２
	IF EXP:噴乳経験 == 0
		EXP:異常経験 += 1
		PRINTL 異常経験＋1
	ENDIF
	EXP:噴乳経験 += 2
	;Ｂに母乳汚れ
	STAIN:5 |= 16

	BASE:3 -= EJAC*2
	SIF BASE:3 >= EJAC
		BASE:3 = EJAC-1

	;調教対象が噴乳フラグ
	TFLAG:11 += 2
	;搾乳器で母乳が集められているかチェック
	SIF TEQUIP:17
		TFLAG:35 += 2

	NOWEX:4 += 1
	EX:4 += 1
;通常の噴乳
ELSEIF E == 1
	LOSEBASE:1 += 40

	IF EXP:噴乳経験 < EXPLV:1
		SOURCE:13 += 5000
		SOURCE:14 += 2500
		SOURCE:15 += 900
	ELSEIF EXP:噴乳経験 < EXPLV:2
		SOURCE:13 += 2500
		SOURCE:14 += 2000
		SOURCE:15 += 700
	ELSEIF EXP:噴乳経験 < EXPLV:3
		SOURCE:13 += 1000
		SOURCE:14 += 800
		SOURCE:15 += 500
	ELSEIF EXP:噴乳経験 < EXPLV:4
		SOURCE:13 += 800
		SOURCE:14 += 600
		SOURCE:15 += 350
	ELSEIF EXP:噴乳経験 < EXPLV:5
		SOURCE:13 += 400
		SOURCE:14 += 400
		SOURCE:15 += 200
	ELSE
		SOURCE:13 += 200
		SOURCE:14 += 250
	ENDIF

	PRINTFORML %NAME:TARGET%は乳首から母乳を垂れ流した
	PRINTL 噴乳経験＋１
	IF EXP:噴乳経験 == 0
		EXP:異常経験 += 1
		PRINTL 異常経験＋1
	ENDIF
	EXP:噴乳経験 += 1
	;Ｂに母乳汚れ
	STAIN:5 |= 16

	BASE:3 -= EJAC
	SIF BASE:3 >= EJAC
		BASE:3 = EJAC-1

	;調教対象が噴乳フラグ
	TFLAG:11 += 1
	;搾乳器で母乳が集められているかチェック
	SIF TEQUIP:17
		TFLAG:35 += 1

	NOWEX:4 += 1
	EX:4 += 1
ENDIF


;-------------------------------------------------
;同性の場合のチェック
;-------------------------------------------------
@SOURCE_SEX_CHECK
SIF (TALENT:オトコ == 0 && TALENT:PLAYER:オトコ) || (TALENT:オトコ && TALENT:PLAYER:オトコ == 0)
	RETURN 0

;レズ
IF TALENT:オトコ == 0 && TALENT:PLAYER:オトコ == 0
	;ABL:レズっ気をみる
	IF ABL:11 == 0
		TIMES SOURCE:14 , 1.20
		TIMES SOURCE:17 , 1.20
	ELSEIF ABL:11 == 1
		TIMES SOURCE:6 , 1.10
	ELSEIF ABL:11 == 2
		TIMES SOURCE:6 , 1.20
		TIMES SOURCE:14 , 0.90
		TIMES SOURCE:17 , 0.90
	ELSEIF ABL:11 == 3
		TIMES SOURCE:6 , 1.30
		TIMES SOURCE:14 , 0.80
		TIMES SOURCE:17 , 0.80
	ELSEIF ABL:11 == 4
		TIMES SOURCE:6 , 1.40
		TIMES SOURCE:14 , 0.70
		TIMES SOURCE:17 , 0.70
	ELSEIF ABL:11 == 5
		TIMES SOURCE:6 , 1.50
		TIMES SOURCE:14 , 0.60
		TIMES SOURCE:17 , 0.60
	ELSEIF ABL:11 == 6
		TIMES SOURCE:6 , 1.60
		TIMES SOURCE:14 , 0.50
		TIMES SOURCE:17 , 0.50
	ELSEIF ABL:11 == 7
		TIMES SOURCE:6 , 1.70
		TIMES SOURCE:14 , 0.40
		TIMES SOURCE:17 , 0.40
	ELSEIF ABL:11 == 8
		TIMES SOURCE:6 , 1.80
		TIMES SOURCE:14 , 0.30
		TIMES SOURCE:17 , 0.30
	ELSEIF ABL:11 == 9
		TIMES SOURCE:6 , 1.90
		TIMES SOURCE:14 , 0.20
		TIMES SOURCE:17 , 0.20
	ELSE
		TIMES SOURCE:6 , 2.00
		TIMES SOURCE:14 , 0.10
		TIMES SOURCE:17 , 0.10
	ENDIF
	
	;ABL:レズ中毒をみる
	IF ABL:17 == 1
		SOURCE:9 += 100
		TIMES SOURCE:0 , 1.10
		TIMES SOURCE:1 , 1.10
		TIMES SOURCE:2 , 1.10
		TIMES SOURCE:3 , 1.10
		TIMES SOURCE:6 , 1.10
		TIMES SOURCE:14 , 0.90
		TIMES SOURCE:15 , 0.90
		TIMES SOURCE:17 , 0.90
	ELSEIF ABL:17 == 2
		SOURCE:9 += 200
		TIMES SOURCE:0 , 1.20
		TIMES SOURCE:1 , 1.20
		TIMES SOURCE:2 , 1.20
		TIMES SOURCE:3 , 1.20
		TIMES SOURCE:6 , 1.20
		TIMES SOURCE:14 , 0.80
		TIMES SOURCE:15 , 0.80
		TIMES SOURCE:17 , 0.80
	ELSEIF ABL:17 == 3
		SOURCE:9 += 350
		TIMES SOURCE:0 , 1.30
		TIMES SOURCE:1 , 1.30
		TIMES SOURCE:2 , 1.30
		TIMES SOURCE:3 , 1.30
		TIMES SOURCE:6 , 1.30
		TIMES SOURCE:14 , 0.70
		TIMES SOURCE:15 , 0.70
		TIMES SOURCE:17 , 0.70
	ELSEIF ABL:17 == 4
		SOURCE:7 += 500
		TIMES SOURCE:0 , 1.40
		TIMES SOURCE:1 , 1.40
		TIMES SOURCE:2 , 1.40
		TIMES SOURCE:3 , 1.40
		TIMES SOURCE:6 , 1.40
		TIMES SOURCE:14 , 0.60
		TIMES SOURCE:15 , 0.60
		TIMES SOURCE:17 , 0.60
	ELSEIF ABL:17 == 5
		SOURCE:9 += 750
		TIMES SOURCE:0 , 1.40
		TIMES SOURCE:1 , 1.40
		TIMES SOURCE:2 , 1.40
		TIMES SOURCE:3 , 1.40
		TIMES SOURCE:6 , 1.40
		TIMES SOURCE:14 , 0.60
		TIMES SOURCE:15 , 0.60
		TIMES SOURCE:17 , 0.60
	ELSEIF ABL:17 == 6
		SOURCE:9 += 1000
		TIMES SOURCE:0 , 1.50
		TIMES SOURCE:1 , 1.50
		TIMES SOURCE:2 , 1.50
		TIMES SOURCE:3 , 1.50
		TIMES SOURCE:6 , 1.50
		TIMES SOURCE:14 , 0.50
		TIMES SOURCE:15 , 0.50
		TIMES SOURCE:17 , 0.50
	ELSEIF ABL:17 == 7
		SOURCE:9 += 1200
		TIMES SOURCE:0 , 1.60
		TIMES SOURCE:1 , 1.60
		TIMES SOURCE:2 , 1.60
		TIMES SOURCE:3 , 1.60
		TIMES SOURCE:6 , 1.60
		TIMES SOURCE:14 , 0.40
		TIMES SOURCE:15 , 0.40
		TIMES SOURCE:17 , 0.40
	ELSEIF ABL:17 == 8
		SOURCE:9 += 1500
		TIMES SOURCE:0 , 1.70
		TIMES SOURCE:1 , 1.70
		TIMES SOURCE:2 , 1.70
		TIMES SOURCE:3 , 1.70
		TIMES SOURCE:6 , 1.70
		TIMES SOURCE:14 , 0.30
		TIMES SOURCE:15 , 0.30
		TIMES SOURCE:17 , 0.30
	ELSEIF ABL:17 == 9
		SOURCE:9 += 1800
		TIMES SOURCE:0 , 1.80
		TIMES SOURCE:1 , 1.80
		TIMES SOURCE:2 , 1.80
		TIMES SOURCE:3 , 1.80
		TIMES SOURCE:6 , 1.80
		TIMES SOURCE:14 , 0.20
		TIMES SOURCE:15 , 0.20
		TIMES SOURCE:17 , 0.20
	ELSEIF ABL:17 >= 10
		SOURCE:9 += 2500
		TIMES SOURCE:0 , 1.90
		TIMES SOURCE:1 , 1.90
		TIMES SOURCE:2 , 1.90
		TIMES SOURCE:3 , 1.90
		TIMES SOURCE:6 , 1.90
		TIMES SOURCE:14 , 0.10
		TIMES SOURCE:15 , 0.10
		TIMES SOURCE:17 , 0.10
	ENDIF

	;調教者のABL:レズっ気
	IF ABL:PLAYER:11 == 0
		TIMES SOURCE:4 , 0.50
		TIMES SOURCE:6 , 0.50
	ELSEIF ABL:PLAYER:11 == 1
		TIMES SOURCE:4 , 0.70
		TIMES SOURCE:6 , 0.70
	ELSEIF ABL:PLAYER:11 == 2
		TIMES SOURCE:4 , 0.90
		TIMES SOURCE:6 , 0.90
	ELSEIF ABL:PLAYER:11 == 3
		TIMES SOURCE:4 , 1.10
		TIMES SOURCE:6 , 1.10
	ELSEIF ABL:PLAYER:11 == 4
		TIMES SOURCE:4 , 1.20
		TIMES SOURCE:6 , 1.20
	ELSEIF ABL:PLAYER:11 == 5
		TIMES SOURCE:4 , 1.30
		TIMES SOURCE:6 , 1.30
	ELSEIF ABL:PLAYER:11 == 6
		TIMES SOURCE:4 , 1.40
		TIMES SOURCE:6 , 1.40
	ELSEIF ABL:PLAYER:11 == 7
		TIMES SOURCE:4 , 1.50
		TIMES SOURCE:6 , 1.50
	ELSEIF ABL:PLAYER:11 == 8
		TIMES SOURCE:4 , 1.60
		TIMES SOURCE:6 , 1.60
	ELSEIF ABL:PLAYER:11 == 9
		TIMES SOURCE:4 , 1.80
		TIMES SOURCE:6 , 1.80
	ELSE
		TIMES SOURCE:4 , 2.00
		TIMES SOURCE:6 , 2.00
	ENDIF

	;調教者のABL:レズ中毒
	IF ABL:PLAYER:17 == 1
		TIMES SOURCE:4 , 1.10
		TIMES SOURCE:5 , 1.10
		TIMES SOURCE:6 , 1.10
	ELSEIF ABL:PLAYER:17 == 2
		TIMES SOURCE:4 , 1.20
		TIMES SOURCE:5 , 1.20
		TIMES SOURCE:6 , 1.20
	ELSEIF ABL:PLAYER:17 == 3
		TIMES SOURCE:4 , 1.30
		TIMES SOURCE:5 , 1.30
		TIMES SOURCE:6 , 1.30
	ELSEIF ABL:PLAYER:17 == 4
		TIMES SOURCE:4 , 1.40
		TIMES SOURCE:5 , 1.40
		TIMES SOURCE:6 , 1.40
	ELSEIF ABL:PLAYER:17 == 5
		TIMES SOURCE:4 , 1.50
		TIMES SOURCE:5 , 1.50
		TIMES SOURCE:6 , 1.50
	ELSEIF ABL:PLAYER:17 == 6
		TIMES SOURCE:4 , 1.60
		TIMES SOURCE:5 , 1.60
		TIMES SOURCE:6 , 1.60
	ELSEIF ABL:PLAYER:17 == 7
		TIMES SOURCE:4 , 1.70
		TIMES SOURCE:5 , 1.70
		TIMES SOURCE:6 , 1.70
	ELSEIF ABL:PLAYER:17 == 8
		TIMES SOURCE:4 , 1.80
		TIMES SOURCE:5 , 1.80
		TIMES SOURCE:6 , 1.80
	ELSEIF ABL:PLAYER:17 == 9
		TIMES SOURCE:4 , 1.90
		TIMES SOURCE:5 , 1.90
		TIMES SOURCE:6 , 1.90
	ELSEIF ABL:PLAYER:17 >= 10
		TIMES SOURCE:4 , 2.00
		TIMES SOURCE:5 , 2.00
		TIMES SOURCE:6 , 2.00
	ENDIF

	;調教者の自制心
	IF TALENT:PLAYER:自制心
		TIMES SOURCE:5 , 0.50
		TIMES SOURCE:6 , 0.50
	ENDIF
ENDIF

;ゲイ
IF TALENT:オトコ && TALENT:PLAYER:オトコ
	;ABL:ホモっ気をみる
	IF ABL:20 == 0
		TIMES SOURCE:14 , 1.20
		TIMES SOURCE:17 , 1.20
	ELSEIF ABL:20 == 1
		TIMES SOURCE:6 , 1.10
	ELSEIF ABL:20 == 2
		TIMES SOURCE:6 , 1.20
		TIMES SOURCE:14 , 0.90
		TIMES SOURCE:17 , 0.90
	ELSEIF ABL:20 == 3
		TIMES SOURCE:6 , 1.30
		TIMES SOURCE:14 , 0.80
		TIMES SOURCE:17 , 0.80
	ELSEIF ABL:20 == 4
		TIMES SOURCE:6 , 1.40
		TIMES SOURCE:14 , 0.70
		TIMES SOURCE:17 , 0.70
	ELSEIF ABL:20 == 5
		TIMES SOURCE:6 , 1.50
		TIMES SOURCE:14 , 0.60
		TIMES SOURCE:17 , 0.60
	ELSEIF ABL:20 == 6
		TIMES SOURCE:6 , 1.60
		TIMES SOURCE:14 , 0.50
		TIMES SOURCE:17 , 0.50
	ELSEIF ABL:20 == 7
		TIMES SOURCE:6 , 1.70
		TIMES SOURCE:14 , 0.40
		TIMES SOURCE:17 , 0.40
	ELSEIF ABL:20 == 8
		TIMES SOURCE:6 , 1.80
		TIMES SOURCE:14 , 0.30
		TIMES SOURCE:17 , 0.30
	ELSEIF ABL:20 == 9
		TIMES SOURCE:6 , 1.90
		TIMES SOURCE:14 , 0.20
		TIMES SOURCE:17 , 0.20
	ELSE
		TIMES SOURCE:6 , 2.00
		TIMES SOURCE:14 , 0.10
		TIMES SOURCE:17 , 0.10
	ENDIF
	
	;ABL:ゲイ中毒をみる
	IF ABL:21 == 1
		SOURCE:9 += 100
		TIMES SOURCE:0 , 1.10
		TIMES SOURCE:1 , 1.10
		TIMES SOURCE:2 , 1.10
		TIMES SOURCE:3 , 1.10
		TIMES SOURCE:6 , 1.10
		TIMES SOURCE:14 , 0.90
		TIMES SOURCE:15 , 0.90
		TIMES SOURCE:17 , 0.90
	ELSEIF ABL:21 == 2
		SOURCE:9 += 200
		TIMES SOURCE:0 , 1.20
		TIMES SOURCE:1 , 1.20
		TIMES SOURCE:2 , 1.20
		TIMES SOURCE:3 , 1.20
		TIMES SOURCE:6 , 1.20
		TIMES SOURCE:14 , 0.80
		TIMES SOURCE:15 , 0.80
		TIMES SOURCE:17 , 0.80
	ELSEIF ABL:21 == 3
		SOURCE:9 += 350
		TIMES SOURCE:0 , 1.30
		TIMES SOURCE:1 , 1.30
		TIMES SOURCE:2 , 1.30
		TIMES SOURCE:3 , 1.30
		TIMES SOURCE:6 , 1.30
		TIMES SOURCE:14 , 0.70
		TIMES SOURCE:15 , 0.70
		TIMES SOURCE:17 , 0.70
	ELSEIF ABL:21 == 4
		SOURCE:7 += 500
		TIMES SOURCE:0 , 1.40
		TIMES SOURCE:1 , 1.40
		TIMES SOURCE:2 , 1.40
		TIMES SOURCE:3 , 1.40
		TIMES SOURCE:6 , 1.40
		TIMES SOURCE:14 , 0.60
		TIMES SOURCE:15 , 0.60
		TIMES SOURCE:17 , 0.60
	ELSEIF ABL:21 == 5
		SOURCE:9 += 750
		TIMES SOURCE:0 , 1.40
		TIMES SOURCE:1 , 1.40
		TIMES SOURCE:2 , 1.40
		TIMES SOURCE:3 , 1.40
		TIMES SOURCE:6 , 1.40
		TIMES SOURCE:14 , 0.60
		TIMES SOURCE:15 , 0.60
		TIMES SOURCE:17 , 0.60
	ELSEIF ABL:21 == 6
		SOURCE:9 += 1000
		TIMES SOURCE:0 , 1.50
		TIMES SOURCE:1 , 1.50
		TIMES SOURCE:2 , 1.50
		TIMES SOURCE:3 , 1.50
		TIMES SOURCE:6 , 1.50
		TIMES SOURCE:14 , 0.50
		TIMES SOURCE:15 , 0.50
		TIMES SOURCE:17 , 0.50
	ELSEIF ABL:21 == 7
		SOURCE:9 += 1200
		TIMES SOURCE:0 , 1.60
		TIMES SOURCE:1 , 1.60
		TIMES SOURCE:2 , 1.60
		TIMES SOURCE:3 , 1.60
		TIMES SOURCE:6 , 1.60
		TIMES SOURCE:14 , 0.40
		TIMES SOURCE:15 , 0.40
		TIMES SOURCE:17 , 0.40
	ELSEIF ABL:21 == 8
		SOURCE:9 += 1500
		TIMES SOURCE:0 , 1.70
		TIMES SOURCE:1 , 1.70
		TIMES SOURCE:2 , 1.70
		TIMES SOURCE:3 , 1.70
		TIMES SOURCE:6 , 1.70
		TIMES SOURCE:14 , 0.30
		TIMES SOURCE:15 , 0.30
		TIMES SOURCE:17 , 0.30
	ELSEIF ABL:21 == 9
		SOURCE:9 += 1800
		TIMES SOURCE:0 , 1.80
		TIMES SOURCE:1 , 1.80
		TIMES SOURCE:2 , 1.80
		TIMES SOURCE:3 , 1.80
		TIMES SOURCE:6 , 1.80
		TIMES SOURCE:14 , 0.20
		TIMES SOURCE:15 , 0.20
		TIMES SOURCE:17 , 0.20
	ELSEIF ABL:21 >= 10
		SOURCE:9 += 2500
		TIMES SOURCE:0 , 1.90
		TIMES SOURCE:1 , 1.90
		TIMES SOURCE:2 , 1.90
		TIMES SOURCE:3 , 1.90
		TIMES SOURCE:6 , 1.90
		TIMES SOURCE:14 , 0.10
		TIMES SOURCE:15 , 0.10
		TIMES SOURCE:17 , 0.10
	ENDIF

	;調教者のABL:ホモっ気
	IF ABL:PLAYER:20 == 0
		TIMES SOURCE:4 , 0.50
		TIMES SOURCE:6 , 0.50
	ELSEIF ABL:PLAYER:20 == 1
		TIMES SOURCE:4 , 0.70
		TIMES SOURCE:6 , 0.70
	ELSEIF ABL:PLAYER:20 == 2
		TIMES SOURCE:4 , 0.90
		TIMES SOURCE:6 , 0.90
	ELSEIF ABL:PLAYER:20 == 3
		TIMES SOURCE:4 , 1.10
		TIMES SOURCE:6 , 1.10
	ELSEIF ABL:PLAYER:20 == 4
		TIMES SOURCE:4 , 1.20
		TIMES SOURCE:6 , 1.20
	ELSEIF ABL:PLAYER:20 == 5
		TIMES SOURCE:4 , 1.30
		TIMES SOURCE:6 , 1.30
	ELSEIF ABL:PLAYER:20 == 6
		TIMES SOURCE:4 , 1.40
		TIMES SOURCE:6 , 1.40
	ELSEIF ABL:PLAYER:20 == 7
		TIMES SOURCE:4 , 1.50
		TIMES SOURCE:6 , 1.50
	ELSEIF ABL:PLAYER:20 == 8
		TIMES SOURCE:4 , 1.60
		TIMES SOURCE:6 , 1.60
	ELSEIF ABL:PLAYER:20 == 9
		TIMES SOURCE:4 , 1.80
		TIMES SOURCE:6 , 1.80
	ELSE
		TIMES SOURCE:4 , 2.00
		TIMES SOURCE:6 , 2.00
	ENDIF

	;調教者のABL:ゲイ中毒
	IF ABL:PLAYER:21 == 1
		TIMES SOURCE:4 , 1.10
		TIMES SOURCE:5 , 1.10
		TIMES SOURCE:6 , 1.10
	ELSEIF ABL:PLAYER:21 == 2
		TIMES SOURCE:4 , 1.20
		TIMES SOURCE:5 , 1.20
		TIMES SOURCE:6 , 1.20
	ELSEIF ABL:PLAYER:21 == 3
		TIMES SOURCE:4 , 1.30
		TIMES SOURCE:5 , 1.30
		TIMES SOURCE:6 , 1.30
	ELSEIF ABL:PLAYER:21 == 4
		TIMES SOURCE:4 , 1.40
		TIMES SOURCE:5 , 1.40
		TIMES SOURCE:6 , 1.40
	ELSEIF ABL:PLAYER:21 == 5
		TIMES SOURCE:4 , 1.50
		TIMES SOURCE:5 , 1.50
		TIMES SOURCE:6 , 1.50
	ELSEIF ABL:PLAYER:21 == 6
		TIMES SOURCE:4 , 1.60
		TIMES SOURCE:5 , 1.60
		TIMES SOURCE:6 , 1.60
	ELSEIF ABL:PLAYER:21 == 7
		TIMES SOURCE:4 , 1.70
		TIMES SOURCE:5 , 1.70
		TIMES SOURCE:6 , 1.70
	ELSEIF ABL:PLAYER:21 == 8
		TIMES SOURCE:4 , 1.80
		TIMES SOURCE:5 , 1.80
		TIMES SOURCE:6 , 1.80
	ELSEIF ABL:PLAYER:21 == 9
		TIMES SOURCE:4 , 1.90
		TIMES SOURCE:5 , 1.90
		TIMES SOURCE:6 , 1.90
	ELSEIF ABL:PLAYER:21 >= 10
		TIMES SOURCE:4 , 2.00
		TIMES SOURCE:5 , 2.00
		TIMES SOURCE:6 , 2.00
	ENDIF

	;調教者の自制心
	IF TALENT:PLAYER:自制心
		TIMES SOURCE:5 , 0.50
		TIMES SOURCE:6 , 0.50
	ENDIF
ENDIF



@PLAYER_SKILL_CHECK
;調教者のTALENT:解放をみる
IF TALENT:PLAYER:解放
	TIMES SOURCE:0 , 1.20
	TIMES SOURCE:1 , 1.20
	TIMES SOURCE:2 , 1.20
	TIMES SOURCE:3 , 1.20
	TIMES SOURCE:4 , 1.20
ENDIF
;調教者のTALENT:両刀をみる
IF TALENT:PLAYER:両刀
	TIMES SOURCE:4 , 1.20
	TIMES SOURCE:5 , 1.20
	TIMES SOURCE:6 , 1.20
ENDIF
;調教者のTALENT:サドをみる
SIF TALENT:PLAYER:サド
	TIMES SOURCE:8 , 1.50
;調教者のTALENT:小悪魔をみる
SIF TALENT:PLAYER:小悪魔
	TIMES SOURCE:13 , 1.50
;調教者のTALENT:魅惑をみる
IF TALENT:PLAYER:魅惑
	TIMES SOURCE:15 , 0.50
	TIMES SOURCE:17 , 0.50

	TIMES SOURCE:0 , 1.20
	TIMES SOURCE:1 , 1.20
	TIMES SOURCE:2 , 1.20
	TIMES SOURCE:3 , 1.20
	TIMES SOURCE:5 , 1.20
ENDIF
;調教者のTALENT:謎の魅力をみる
IF TALENT:PLAYER:謎の魅力
	TIMES SOURCE:15 , 0.50
	TIMES SOURCE:17 , 0.50

	TIMES SOURCE:0 , 1.20
	TIMES SOURCE:1 , 1.20
	TIMES SOURCE:2 , 1.20
	TIMES SOURCE:3 , 1.20
	TIMES SOURCE:5 , 1.20
	TIMES SOURCE:6 , 1.50
ENDIF

;-------------------------------------------------
;絶頂時の放尿処理
;-------------------------------------------------
@ORGASM_ADD_URINE
SIF TFLAG:29 == 0
	RETURN 0

IF TFLAG:29 >= 7 && TEQUIP:27 && TALENT:おもらし癖
	PRINTFORML %EXPNAME:31%＋５
	EXP:放尿経験 += 5
ELSEIF TFLAG:29 >= 7 && TEQUIP:27
	PRINTFORML %EXPNAME:31%＋４
	EXP:放尿経験 += 4
ELSEIF TFLAG:29 >= 7 && TALENT:おもらし癖
	PRINTFORML %EXPNAME:31%＋３
	EXP:放尿経験 += 3
ELSEIF P >= 5 && TEQUIP:27 && TALENT:おもらし癖
	PRINTFORML %EXPNAME:31%＋４
	EXP:放尿経験 += 4
ELSEIF TFLAG:29 >= 5 && TEQUIP:27
	PRINTFORML %EXPNAME:31%＋３
	EXP:放尿経験 += 3
ELSEIF TFLAG:29 >= 5 && TALENT:おもらし癖
	PRINTFORML %EXPNAME:31%＋２
	EXP:放尿経験 += 2
ELSEIF TFLAG:29 >= 3 && TEQUIP:27 && TALENT:おもらし癖
	PRINTFORML %EXPNAME:31%＋３
	EXP:放尿経験 += 3
ELSEIF TFLAG:29 >= 3 && TEQUIP:27
	PRINTFORML %EXPNAME:31%＋２
	EXP:放尿経験 += 2
ELSEIF TFLAG:29 >= 3 && TALENT:おもらし癖
	PRINTFORML %EXPNAME:31%＋１
	EXP:放尿経験 += 1
ELSEIF TFLAG:29 >= 1 && TEQUIP:27 && TALENT:おもらし癖
	PRINTFORML %EXPNAME:31%＋２
	EXP:放尿経験 += 2
ELSEIF TFLAG:29 >= 1 && TEQUIP:27
	PRINTFORML %EXPNAME:31%＋１
	EXP:放尿経験 += 1
ENDIF
SIF TEQUIP:27 && (TFLAG:29 >= 3 || TALENT:おもらし癖)
	TEQUIP:27 = 0

;-------------------------------------------------
;刻印取得のチェック
;-------------------------------------------------
@MARK_GOT_CHECK
;-------------------------------------------------
;苦痛刻印
;-------------------------------------------------
IF UP:10 >= 2000 && UP:10 < 4000 && MARK:0 <= 0
	TFLAG:22 = 1
ELSEIF UP:10 >= 4000 && UP:10 < 8000 && MARK:0 <= 1
	TFLAG:22 = 2
	;気丈・感情乏しいの場合は苦痛刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:気丈 == 0 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ENDIF
ELSEIF UP:10 >= 8000 && MARK:0 <= 2
	TFLAG:22 = 3
	;気丈・感情乏しいの場合は苦痛刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:気丈 == 0 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ENDIF
ENDIF


;-------------------------------------------------
;快楽刻印
;-------------------------------------------------
IF TFLAG:200 == 1 && MARK:1 <= 0
	TFLAG:23 = 1
ELSEIF TFLAG:200 == 2 && MARK:1 <= 1
	TFLAG:23 = 2
ELSEIF TFLAG:200 == 3 && MARK:1 <= 2
	TFLAG:23 = 3
	;自制心・感情乏しいの場合は快楽刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:自制心 == 0 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ENDIF
ENDIF

;-------------------------------------------------
;屈服刻印
;-------------------------------------------------
A = UP:0 + UP:1 + UP:2 + UP:3

;快楽によるLvUPは10番+取得した屈服刻印のレベルのTFLAGを与える
IF A >= 1000 && A < 2400 && MARK:1 > MARK:2 && MARK:2 <= 0
	TFLAG:24 = 11
ELSEIF A >= 2400 && A < 6000 && MARK:1 > MARK:2 && MARK:2 <= 1
	TFLAG:24 = 12
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ENDIF
ELSEIF A >= 6000 && MARK:1 > MARK:2 && MARK:2 <= 2
	TFLAG:24 = 13
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 <= 1 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ENDIF
ENDIF


A = UP:10 + UP:11

;苦痛と恐怖によるLvUPは20番+取得した屈服刻印のレベルのTFLAGを与える
IF A >= 1000 && A < 2400 && MARK:2 <= 0
	TFLAG:24 = 21
ELSEIF A >= 2400 && A < 6000 && MARK:2 <= 1
	TFLAG:24 = 22
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ENDIF
ELSEIF A >= 6000 && MARK:2 <= 2
	TFLAG:24 = 23
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 <= 1 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ENDIF
ENDIF


A = UP:5 + UP:7

;恭順と屈服によるLvUPは30番+取得した屈服刻印のレベルのTFLAGを与える
IF A >= 1000 && A < 2400 && MARK:2 <= 0
	TFLAG:24 = 31
ELSEIF A >= 2400 && A < 6000 && MARK:2 <= 1
	TFLAG:24 = 32
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 == 0 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ENDIF
ELSEIF A >= 6000 && MARK:2 <= 2
	TFLAG:24 = 33
	;感情乏しいの場合は屈服刻印による従順アップはなし
	IF ABL:0 <= 1 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ENDIF
ENDIF

;-------------------------------------------------
;反発刻印
;------------------------------------------------- 
A = UP:12+UP:13
IF A >= 500 && A < 1200 && MARK:4 <= 0 && TFLAG:150 == 0
	TFLAG:21 = 1
ELSEIF A >= 1200 && A < 3000 && MARK:4 <= 1 && TFLAG:150 == 0
	TFLAG:21 = 2
	;感情乏しいの場合は反発刻印による従順ダウンはなし
	IF ABL:0 == 1 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ELSEIF ABL:0 == 2 && TALENT:感情乏しい == 0
		TFLAG:25 = 2
	ENDIF
ELSEIF A >= 3000 && MARK:4 <= 2 && TFLAG:150 == 0
	TFLAG:21 = 3
	;感情乏しいの場合は反発刻印による従順ダウンはなし
	IF ABL:0 > 0 && ABL:0 <= 2 && TALENT:感情乏しい == 0
		TFLAG:25 = 1
	ELSEIF ABL:0 == 3 && TALENT:感情乏しい == 0
		TFLAG:25 = 2
	ENDIF
ENDIF
TFLAG:150 = 0


;-------------------------------------------------
;刻印取得の処理
;-------------------------------------------------
@MARK_GOT_RESULT
;------------------------------------------------- 
;苦痛刻印
;------------------------------------------------- 
IF TFLAG:22 == 1
	PRINTFORMW %CALLNAME:TARGET%は苦痛刻印LV1を得た
	MARK:0 = 1
ELSEIF TFLAG:22 == 2
	PRINTFORML %CALLNAME:TARGET%は苦痛刻印LV2を得た
	MARK:0 = 2
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTW そして従順がLV1になった
		ABL:0 = 1
	ELSE
		WAIT
	ENDIF
ELSEIF TFLAG:22 == 3
	PRINTFORML %CALLNAME:TARGET%は苦痛刻印LV3を得た
	MARK:0 = 3
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTL そして従順がLV1になった
		ABL:0 = 1
	ENDIF
	IF TALENT:PLAYER:サド
		PRINTFORML 【%CALLNAME:PLAYER%がサド】
		PRINTFORMW %EXPNAME:50%＋２
		EXP:異常経験 += 2
	ELSEIF TALENT:PLAYER:針さばき && SELECTCOM == 104
		PRINTFORML 【%CALLNAME:PLAYER%が針さばき】
		PRINTFORMW %EXPNAME:50%＋２
		EXP:異常経験 += 2
	ELSE
		PRINTFORMW %EXPNAME:50%＋１
		EXP:異常経験 += 1
	ENDIF
ENDIF


;------------------------------------------------- 
;快楽刻印
;------------------------------------------------- 
IF TFLAG:23 == 1
	PRINTFORMW %CALLNAME:TARGET%は快楽刻印LV1を得た
	MARK:1 = 1
ELSEIF TFLAG:23 == 2
	PRINTFORMW %CALLNAME:TARGET%は快楽刻印LV2を得た
	MARK:1 = 2
ELSEIF TFLAG:23 == 3
	PRINTFORML %CALLNAME:TARGET%は快楽刻印LV3を得た
	MARK:1 = 3
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTW そして従順がLV1になった
		ABL:0 = 1
	ELSE
		WAIT
	ENDIF
ENDIF


;------------------------------------------------- 
;屈服刻印
;------------------------------------------------- 
;快楽による刻印
IF TFLAG:24 == 11
	PRINTFORMW %CALLNAME:TARGET%は屈服刻印LV1を得た
	MARK:2 = 1
ELSEIF TFLAG:24 == 12
	PRINTFORML %CALLNAME:TARGET%は屈服刻印LV2を得た
	MARK:2 = 2
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTW そして従順がLV1になった
		ABL:0 = 1
	ENDIF
ELSEIF TFLAG:24 == 13
	PRINTFORML %CALLNAME:TARGET%は屈服刻印LV3を得た
	MARK:2 = 3
	IF TFLAG:25 == 1 && ABL:0 <= 1
		PRINTW そして従順がLV2になった
		ABL:0 = 2
	ELSE
		WAIT
	ENDIF
;苦痛、恐怖による刻印
ELSEIF TFLAG:24 == 21
	PRINTFORMW %CALLNAME:TARGET%は屈服刻印LV1を得た
	MARK:2 = 1
ELSEIF TFLAG:24 == 22
	PRINTFORML %CALLNAME:TARGET%は屈服刻印LV2を得た
	MARK:2 = 2
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTW そして従順がLV1になった
		ABL:0 = 1
	ELSE
		WAIT
	ENDIF
ELSEIF TFLAG:24 == 23
	PRINTFORML %CALLNAME:TARGET%は屈服刻印LV3を得た
	MARK:2 = 3
	IF TFLAG:25 == 1  && ABL:0 <= 1
		PRINTW そして従順がLV2になった
		ABL:0 = 2
	ELSE
		WAIT
	ENDIF
;屈服、恭順による刻印
ELSEIF TFLAG:24 == 31
	PRINTFORMW %CALLNAME:TARGET%は屈服刻印LV1を得た
	MARK:2 = 1
ELSEIF TFLAG:24 == 32
	PRINTFORML %CALLNAME:TARGET%は屈服刻印LV2を得た
	MARK:2 = 2
	IF TFLAG:25 == 1 && ABL:0 == 0
		PRINTW そして従順がLV1になった
		ABL:0 = 1
	ELSE
		WAIT
	ENDIF
ELSEIF TFLAG:24 == 33
	PRINTFORML %CALLNAME:TARGET%は屈服刻印LV3を得た
	MARK:2 = 3
	IF TFLAG:25 == 1 && ABL:0 <= 1
		PRINTW そして従順がLV2になった
		ABL:0 = 2
	ELSE
		WAIT
	ENDIF
ENDIF


;------------------------------------------------- 
;反発刻印
;------------------------------------------------- 
IF TFLAG:21 == 1
	PRINTFORMW %CALLNAME:TARGET%は反発刻印LV1を得た
	MARK:3 = 1
	MARK:4 = 1
ELSEIF TFLAG:21 == 2
	PRINTFORML %CALLNAME:TARGET%は反発刻印LV2を得た
	MARK:3 = 2
	MARK:4 = 2
	IF TFLAG:25 == 1
		PRINTW そして従順がLV0に下がった
		ABL:0 = 0
	ELSEIF TFLAG:25 == 2
		PRINTW そして従順がLV1に下がった
		ABL:0 = 1
	ELSE
		WAIT
	ENDIF
ELSEIF TFLAG:21 == 3
	PRINTFORML %CALLNAME:TARGET%は反発刻印LV3を得た
	MARK:3 = 3
	MARK:4 = 3
	IF TFLAG:25 == 1
		PRINTW そして従順がLV0に下がった
		ABL:0 = 0
	ELSEIF TFLAG:25 == 2
		PRINTW そして従順がLV2に下がった
		ABL:0 = 2
	ELSE
		WAIT
	ENDIF
ENDIF


;-------------------------------------------------
;従順の上昇による[抵抗]の消滅をチェック
;-------------------------------------------------
@JUJUN_UP_CHECK
IF ABL:0 >= 3 && TALENT:抵抗
	PRINTS NAME:TARGET
	PRINT は[
	PRINTS TALENTNAME:34
	PRINTL ]を失った
	TALENT:抵抗 = 0
	PRINTL 否定の珠が半分になった
	JUEL:100 /= 2
ENDIF

;-------------------------------------------------
;欲望の上昇による[抑圧]の消滅をチェック
;-------------------------------------------------
@YOKUBO_UP_CHECK
IF ABL:1 >= 3 && TALENT:抑圧
	PRINTS NAME:TARGET
	PRINT は[
	PRINTS TALENTNAME:32
	PRINTL ]を失った
	TALENT:抑圧 = 0
	PRINTL 否定の珠が半分になった
	JUEL:100 /= 2
ENDIF

;-------------------------------------------------
;苦痛快楽経験、奉仕快楽経験のチェック
;-------------------------------------------------
@EXP_GOT_CHECK
;奉仕系である、奉仕快楽のチェック
A = UP:0+UP:1+UP:2+UP:3
E = 0

IF UP:6 < 100
	A = 0
ELSEIF UP:6 < 300
	A *= 2
ELSEIF UP:6 < 700
	A *= 3
ELSEIF UP:6 < 1500
	A *= 4
ELSE
	A *= 5
ENDIF

IF TFLAG:100
	IF A >= 12000
		E = 16
		TIMES UP:11 , 0.65
		TIMES UP:12 , 0.30
	ELSEIF A >= 8000
		E = 12
		TIMES UP:11 , 0.70
		TIMES UP:12 , 0.40
	ELSEIF A >= 5000
		E = 8
		TIMES UP:11 , 0.75
		TIMES UP:12 , 0.50
	ELSEIF A >= 3000
		E = 4
		TIMES UP:11 , 0.80
		TIMES UP:12 , 0.60
	ELSEIF A >= 2000
		E = 2
		TIMES UP:11 , 0.85
		TIMES UP:12 , 0.70
	ELSEIF A >= 1000
		E = 1
		TIMES UP:11 , 0.90
		TIMES UP:12 , 0.80
	ENDIF
	IF E
		PRINT 奉仕快楽経験+
		PRINTVL E
		EXP:奉仕快楽経験 += E
		TFLAG:26 = E
	ENDIF
ENDIF

;苦痛快楽のチェック
E = 0
IF UP:6 >= 3000 && UP:10 >= 2000
	E = 16
	TIMES UP:11 , 0.65
ELSEIF UP:6 >= 2500 && UP:10 >= 1500
	E = 12
	TIMES UP:11 , 0.70
ELSEIF UP:6 >= 1500 && UP:10 >= 1000
	E = 8
	TIMES UP:11 , 0.75
ELSEIF UP:6 >= 1000 && UP:10 >= 500
	E = 4
	TIMES UP:11 , 0.80
ELSEIF UP:6 >= 600 && UP:10 >= 300
	E = 2
	TIMES UP:11 , 0.85
ELSEIF UP:6 >= 300 && UP:10 >= 100
	E = 1
	TIMES UP:11 , 0.90
ENDIF
IF E > 0
	PRINT 苦痛快楽経験+
	PRINTVL E
	EXP:苦痛快楽経験 += E
	TFLAG:27 = E
	;嗜虐快楽経験
	E = ABL:PLAYER:10+ABL:9
	E -= 1
	IF E > 0
		PRINTFORM %CALLNAME:PLAYER%の
		PRINT 嗜虐快楽経験+
		PRINTVL E
		EXP:PLAYER:嗜虐快楽経験 += E
		TFLAG:28 = E
	ENDIF
ENDIF


