;=============================================================================
; 搭乗可能な奴隷の一覧表示
;=============================================================================
@SHOW_BOARDING_SLAVE_LIST
#DIM ITER
FOR ITER, 0, CHARANUM
	SIF CFLAG:ITER:捕虜先 == 国家ID_プレイヤー || CFLAG:ITER:所属 != 国家ID_プレイヤー
		CONTINUE
	IF BOARDING_SHIP_ID:ITER != -1
		PRINTBUTTON @"[{ITER, 2, RIGHT}] %CALLNAME:ITER, 30, LEFT% %SHIP_NAME:(BOARDING_SHIP_ID:ITER)%の艦長", ITER
	ELSEIF RIDING_WITH:ITER != -1
		PRINTBUTTON @"[{ITER, 2, RIGHT}] %CALLNAME:ITER, 30, LEFT% %SHIP_NAME:(RIDING_WITH:ITER)%搭乗中", ITER
	ELSE
		PRINTBUTTON @"[{ITER, 2, RIGHT}] %CALLNAME:ITER, 30, LEFT%", ITER
	ENDIF
PRINTL
NEXT

@MOORING(CHARA_ID = 0)
#FUNCTION
#DIM CHARA_ID
#DIM ID

FOR ID, 0, 星系数
	SIF 星系座標ID:ID == CHARACTER_POSITION:CHARA_ID
		RETURNF 1
NEXT

FOR ID, 0, MAX_PORT
	SIF PORT_POSITION_ID:ID == CHARACTER_POSITION:CHARA_ID
		RETURNF 1
NEXT

RETURNF 0

;座標からどの星にいるかを返却する
@GET_STAR_ID_FROM_POS(POS)
#DIM POS

FINDELEMENT 星系座標ID, POS
RETURN RESULT

;座標からどの星にいるかを返却する
@GET_PORT_ID_FROM_POS(POS)
#DIM POS

FINDELEMENT PORT_POSITION_ID, POS
RETURN RESULT

;各種タスクから解放する
@RELEASE_FROM_TASK(ID)
#DIM ID
#DIM 塔乗艦ID

塔乗艦ID = BOARDING_SHIP_ID:ID
IF 塔乗艦ID != -1
	BOARDING_SHIP_ID:ID = -1
	SHIP_MISSION:塔乗艦ID = 0
	SHIP_FOLLOW:塔乗艦ID = -1
	SHIP_PATROL:塔乗艦ID = -1
ENDIF
塔乗艦ID = RIDING_WITH:ID
SIF 塔乗艦ID != -1
	RIDING_WITH:ID = -1
FINDELEMENT R_SUPERVISER_IS, ID
SIF RESULT != -1
	R_SUPERVISER_IS:RESULT = 0
FINDELEMENT SHOP_IN_CHARGE, ID
SIF RESULT != -1
	SHOP_IN_CHARGE:RESULT = -1


; 乗船以外のジョブから解任
@DISMISSAL_JOB(ID)
#DIM ID
FINDELEMENT R_SUPERVISER_IS, ID
IF RESULT != -1
	R_SUPERVISER_IS:RESULT = 0
	R_SUPERVISER_COST:RESULT = 0
ENDIF
SIF R_MILITARY_ADVISER == ID
	R_MILITARY_ADVISER = -1

@TO_FREE(ID)
#DIM ID
CALL RELEASE_FROM_TASK(ID)
CALL DISMISSAL_JOB(ID)
