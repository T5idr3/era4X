勢力指定近傍船検索関数パッチ

◇やりたい事
「いい感じに近い所に居る〇〇の船」を自動で探し出す手段がなさそうだったので
「(敵勢力艦)に向けて(船扱いの)戦略級ミサイルを発射！」とか「(勢力名A)からの刺客艦隊が(勢力名B)の艦艇××を付け狙う！」とかをやるベースになれそうな「移動距離的に近い(指定した特定勢力)の船」を探す関数を用意する。



◇ERBフォルダ内容物説明

・POS_DISTANCE_CHECK.ERB
@NEAREST_ANY_COUNTRY_SHIP_CHECK
勢力指定近傍船検索関数です。
近傍と言いつつ「自動移動で移動した時に一番短い距離で移動できるはずの位置の船」を探す関数です。
自動移動は常に最短航路を取る訳ではないので真に近傍の船を探す手段としては不適切ですが
「一番手近な敵艦に(「追従」で)自動移動で追いかけて行く艦隊を差し向ける」などをさせる時に使う事を想定しています。

RESULTで「指定した勢力の・指定した位置から一番短い距離で自動移動できる位置の船」のIDか、船が存在しなかった場合には"-1"を返します。


@POS_DISTANCE_CHECK
指定された2つの座標の「自動移動時の移動距離」を返す関数です。
自動移動の性質上「自動移動する船を想定したMOVER」と、「自動移動で辿り着きたい終点としてのTARGET」を入れ替える事はできません。
(自動移動時にあるセクターから斜め隣りのセクターの「特定の経路を通ればより短い行き方が出来る」ポイントを指定した場合、行き来の一方ではより短いルートで、行き来のもう一方ではより遠いルートで移動するのが確認できると思います)

RESULT:0でMOVERとTARGETの居るセクターの距離
RESULT:1で(TARGETが静止しているものとして)MOVERが自動航行でTARGETまで移動する場合の距離
を返します。


◇テスト用フォルダ内容物説明
あくまで関数の挙動を確かめる為のものであり、通常時に利用する事を想定したものではありません。

・勢力指定近傍船検索テスト用関数.ERB
@MOVING_DISTANCE_SHOW
POS_DISTANCE_CHECKのテスト用関数です。
「自分の居る位置から・クリックして指定したポイントまで」自動移動する場合の移動距離を表示します。

@NEAREST_ANY_COUNTRY_SHIP_SHOW
NEAREST_ANY_COUNTRY_SHIP_CHECKのテスト用関数です。
指定した勢力の「自動移動で移動した時に一番短い距離で移動できるはずの位置の船」の名前と座標を表示するか、「その勢力に船は無い」旨を表示します。
テスト用なので明確になさそうなマイナス2～0と13～15番の勢力番号も選択可能にしてあります。
("0"の場合には初期化された艦船データなのか「セクター0のX0・Y0に名前の無い船がある」事になっている様です)


・SLG_SHOP.ERB
@SLG_SHOP
MOVING_DISTANCE_SHOWとNEAREST_ANY_COUNTRY_SHIP_SHOWを呼び出せる様に手を加えてあります。
